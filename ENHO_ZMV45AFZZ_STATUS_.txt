<?xml version="1.0" encoding="utf-8"?> <ENHO enhancement_id="ZMV45AFZZ_STATUS" shorttext="ZMV45AFZZ_STATUS" tooltype_id="HOOK_IMPL" orig_object="R3TR-SAPMV45A-PROG-SAPMV45A">  <asx:abap xmlns:asx="http://www.sap.com/abapxml" version="1.0">   <asx:values>
   <IMPLS>     <ENH_HOOK_IMPL>      <SPOTNAME/>      <PROGRAMNAME>SAPMV45A</PROGRAMNAME>      <EXTID>1</EXTID>      <ID>1</ID>      <OVERWRITE/>      <METHOD/>      <ENHMODE>D</ENHMODE>      <FULL_NAME>\PR:SAPMV45A\FO:USEREXIT_SAVE_DOCUMENT\SE:END\EI</FUL
L_NAME>      <SOURCE>       <item>*</item>       <item/>       <item>************************************************************************</item>       <item>*** Parámetros locales</item>       <item>****************************************************
********************</item>       <item>**</item>       <item>**  DATA: ls_xvbap TYPE vbap,</item>       <item>**        lv_estat TYPE j_estat,</item>       <item>**        lv_msg   TYPE string.</item>       <item>**</item>       <item>*******************
*****************************************************</item>       <item>*** Lógica</item>       <item>************************************************************************</item>       <item>**</item>       <item>*** Modificamos estado para cada posic
ión.</item>       <item>**</item>       <item>**  LOOP AT xvbap INTO ls_xvbap.</item>       <item>**</item>       <item>**    CLEAR: lv_estat, lv_msg.</item>       <item>**</item>       <item>**    SELECT SINGLE estat</item>       <item>**      FROM tj30t
</item>       <item>**      INTO lv_estat</item>       <item>**     WHERE txt04 = ls_xvbap-zstatp</item>       <item>**       AND STSMA = &apos;ZS000001&apos;</item>       <item>**       AND spras = &apos;S&apos;.</item>       <item>**</item>       <item>
**    IF ( lv_estat IS NOT INITIAL ).</item>       <item>**</item>       <item>**      CALL FUNCTION &apos;STATUS_CHANGE_EXTERN&apos;</item>       <item>**        EXPORTING</item>       <item>***         CHECK_ONLY                = &apos; &apos;</item>
    <item>***         CLIENT                    = SY-MANDNOT</item>       <item>**          objnr                     = ls_xvbap-objnr</item>       <item>**          user_status               = lv_estat</item>       <item>***         SET_INACT
     = &apos; &apos;</item>       <item>***         SET_CHGKZ                 =</item>       <item>***         NO_CHECK                  = &apos; &apos;</item>       <item>***       IMPORTING</item>       <item>***         STONR                     =</ite
m>       <item>**       EXCEPTIONS</item>       <item>**         object_not_found          = 1</item>       <item>**         status_inconsistent       = 2</item>       <item>**         status_not_allowed        = 3</item>       <item>**         OTHERS
                = 4</item>       <item>**                .</item>       <item>**      IF ( sy-subrc &lt;&gt; 0 ).</item>       <item>**        CONCATENATE &apos;Pos.&apos; ls_xvbap-posnr &apos;:&apos; &apos;No ha sido posible modificar status de usuario.&
apos; INTO lv_msg SEPARATED BY space.</item>       <item>**        MESSAGE lv_msg TYPE &apos;W&apos;.</item>       <item>**      ENDIF.</item>       <item>**</item>       <item>**    ENDIF.</item>       <item>**</item>       <item>**  ENDLOOP.</item>
  <item/>      </SOURCE>      <PARENT_FULL_NAME/>     </ENH_HOOK_IMPL>    </IMPLS>   </asx:values>  </asx:abap> </ENHO>
