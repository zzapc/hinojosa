*---------------------------------------------------------------------*
* Include ZSEI_MIG_00005_FORM
*---------------------------------------------------------------------*

*---------------------------------------------------------------------*
* Form GET_DATA
*---------------------------------------------------------------------*
FORM get_data.

  SELECT lifnr kunnr
    FROM lfa1
    INTO CORRESPONDING FIELDS OF TABLE gt_lfa1
    WHERE lifnr IN r_lifnr.

  IF gt_lfa1[] IS NOT INITIAL.

    SELECT kunnr lifnr                             "#EC CI_NO_TRANSFORM
       FROM kna1
       INTO CORRESPONDING FIELDS OF TABLE gt_kna1
       FOR ALL ENTRIES IN gt_lfa1
       WHERE kunnr = gt_lfa1-kunnr
       AND kunnr IN r_kunnr.

    IF sy-subrc <> 0.
      MESSAGE text-000 TYPE 'E'.
    ENDIF.

  ELSE.

    MESSAGE text-000 TYPE 'E'.

  ENDIF.

ENDFORM.

*---------------------------------------------------------------------*
*      Form  FILL_ALV_TABLE
*---------------------------------------------------------------------*
FORM fill_alv_table.

  DATA:
    tl_kna1                TYPE TABLE OF kna1,
    ls_kna1                TYPE kna1,
    tl_lfa1                TYPE TABLE OF lfa1,
    ls_lfa1                TYPE lfa1,
    lv_cli_lfa1            TYPE lfa1-kunnr,
    lv_pro_lfa1            TYPE lfa1-lifnr,
    wl_cont                TYPE sy-tabix,
    wa_dentro              TYPE c1,
    wal_phone_customer     TYPE cvis_ei_phone_str,
    wal_mob_phone_customer TYPE cvis_ei_phone_str,
    wal_phone_vendor       TYPE cvis_ei_phone_str,
    wal_mob_phone_vendor   TYPE cvis_ei_phone_str,
    wal_fax_customer       TYPE cvis_ei_fax_str,
    wal_fax_vendor         TYPE cvis_ei_fax_str,
    wal_smtp_customer      TYPE cvis_ei_smtp_str,
    wal_smtp_vendor        TYPE cvis_ei_smtp_str,
    wa_subrc               TYPE sy-subrc,
    wal_comments_customer  TYPE cvis_ei_comrem,
    wal_comments_vendor    TYPE cvis_ei_comrem,
    ls_contador_customer   TYPE i,
    ls_contador_vendors    TYPE i,
    wa_customer_detail     TYPE cmds_ei_extern,
    wa_vendors_detail      TYPE vmds_ei_extern.

  IF gt_kna1[] IS NOT INITIAL.
    SELECT kunnr lifnr                             "#EC CI_NO_TRANSFORM
      FROM lfa1
      INTO CORRESPONDING FIELDS OF TABLE tl_lfa1
       FOR ALL ENTRIES IN gt_kna1
      WHERE kunnr = gt_kna1-kunnr.
  ENDIF.

  IF gt_lfa1[] IS NOT INITIAL.
    SELECT lifnr kunnr FROM kna1                   "#EC CI_NO_TRANSFORM
      INTO CORRESPONDING FIELDS OF TABLE tl_kna1
      FOR ALL ENTRIES IN gt_lfa1
      WHERE lifnr = gt_lfa1-lifnr.
  ENDIF.

  SORT gt_kna1 ASCENDING.

  IF gt_kna1 IS NOT INITIAL.

    LOOP AT gt_kna1 INTO gs_kna1.

      CLEAR: cli_lfa1, pro_lfa1.

      LOOP AT gt_lfa1 INTO gs_lfa1 WHERE kunnr = gs_kna1-kunnr.
        IF gs_lfa1-lifnr <> gs_kna1-lifnr.
          cli_lfa1 = gs_lfa1-kunnr.
          pro_lfa1 = gs_lfa1-lifnr.
        ENDIF.
      ENDLOOP.

      CLEAR: wl_cont.
      CLEAR: lv_cli_lfa1, lv_pro_lfa1.

      LOOP AT tl_lfa1 INTO ls_lfa1 WHERE kunnr = gs_lfa1-kunnr.
        wl_cont = wl_cont + 1.
        IF ls_lfa1-lifnr <> gs_lfa1-lifnr.
          lv_pro_lfa1 = ls_lfa1-lifnr.
        ENDIF.
      ENDLOOP.

      IF wl_cont = 1.
      ELSE.
        CLEAR gs_alv.
        gs_alv-kunnr = gs_kna1-kunnr.
        gs_alv-provlfa1 = gs_kna1-lifnr.
        gs_alv-lifnr = lv_pro_lfa1.
        gs_alv-campo_erroneo = 'LFA1'.
        gs_alv-desc_camp_e = text-900. "'Más de un proveedor está asociado al mismo cliente.'.
        APPEND gs_alv TO gt_alv.
        CONTINUE.
      ENDIF.

      CLEAR: wl_cont.
      CLEAR: lv_cli_lfa1, lv_pro_lfa1.

      LOOP AT tl_kna1 INTO ls_kna1 WHERE lifnr = gs_kna1-lifnr.
        wl_cont = wl_cont + 1.
        IF ls_kna1-kunnr <> gs_kna1-kunnr.
          lv_cli_lfa1 = ls_kna1-kunnr.
        ENDIF.
      ENDLOOP.
      IF wl_cont = 1.
      ELSE.
        CLEAR gs_alv.
        gs_alv-kunnr = gs_kna1-kunnr.
        gs_alv-clilfa1 = lv_cli_lfa1.
        gs_alv-provlfa1 = gs_kna1-lifnr.
        gs_alv-campo_erroneo = 'KNA1'.
        gs_alv-desc_camp_e = text-901. "'Más de un cliente está asociado al mismo proveedor.'.
        APPEND gs_alv TO gt_alv.
        CONTINUE.
      ENDIF.

      IF gs_kna1-lifnr IS NOT INITIAL AND gs_kna1-kunnr IS NOT INITIAL.

        CLEAR: ls_customer_detail, ls_vendors_detail, lt_customer, ls_customer_read, ls_vendors_read, lt_vendors, ls_vend_bankdetail, ls_cust_bankdetail.

        ls_customer-header-object_instance-kunnr = gs_kna1-kunnr.
        ls_customer-header-object_task = 'M'.
        APPEND ls_customer TO lt_customer-customers.

        cmd_ei_api_extract=>get_data(   "Cliente
          EXPORTING
            is_master_data = lt_customer
          IMPORTING
            es_master_data = ls_customer_read
            es_error       = ls_errors_cli ).

        ls_vendors-header-object_instance-lifnr = gs_kna1-lifnr.
        ls_vendors-header-object_task = 'M'.
        APPEND ls_vendors TO lt_vendors-vendors.

        vmd_ei_api_extract=>get_data(   "proveedor
          EXPORTING
            is_master_data = lt_vendors
         IMPORTING
            es_master_data = ls_vendors_read
            es_error       = ls_errors_ven ).

        READ TABLE ls_customer_read-customers INTO ls_customer_detail  WITH KEY header-object_instance-kunnr = gs_kna1-kunnr.
        READ TABLE ls_vendors_read-vendors    INTO ls_vendors_detail   WITH KEY header-object_instance-lifnr = gs_kna1-lifnr.
        IF sy-subrc = 0.

          "Check postal data are from customer and venor are the same
*          IF ls_customer_detail-central_data-address-postal-data <> ls_vendors_detail-central_data-address-postal-data.

          IF ls_customer_detail-central_data-address-postal-data-addr_vers <> ls_vendors_detail-central_data-address-postal-data-addr_vers.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'ADDR_VERS'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-addr_vers.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-addr_vers.
            gs_alv-desc_camp_e = text-988.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-from_date <> ls_vendors_detail-central_data-address-postal-data-from_date.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'FROM_DATE'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-from_date.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-from_date.
            gs_alv-desc_camp_e = text-944.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-to_date <> ls_vendors_detail-central_data-address-postal-data-to_date.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'TO_DATE'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-to_date.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-to_date.
            gs_alv-desc_camp_e = text-945.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-title <> ls_vendors_detail-central_data-address-postal-data-title.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'TITLE'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-title.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-title.
            gs_alv-desc_camp_e = text-946.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-name <> ls_vendors_detail-central_data-address-postal-data-name.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'NAME'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-name.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-name.
            gs_alv-desc_camp_e = text-902.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-name_2 <> ls_vendors_detail-central_data-address-postal-data-name_2.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'NAME_2'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-name_2.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-name_2.
            gs_alv-desc_camp_e = text-947.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-name_3 <> ls_vendors_detail-central_data-address-postal-data-name_3.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'NAME_3'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-name_3.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-name_3.
            gs_alv-desc_camp_e = text-948.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-name_4 <> ls_vendors_detail-central_data-address-postal-data-name_4.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'NAME_4'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-name_4.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-name_4.
            gs_alv-desc_camp_e = text-949.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-conv_name <> ls_vendors_detail-central_data-address-postal-data-conv_name.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'CONV_NAME'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-conv_name.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-conv_name.
            gs_alv-desc_camp_e = text-950.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-c_o_name <> ls_vendors_detail-central_data-address-postal-data-c_o_name.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'C_O_NAME'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-c_o_name.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-c_o_name.
            gs_alv-desc_camp_e = text-951.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-city <> ls_vendors_detail-central_data-address-postal-data-city.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'CITY'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-city.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-city.
            gs_alv-desc_camp_e = text-952.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-district <> ls_vendors_detail-central_data-address-postal-data-district.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'DISTRICT'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-district.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-district.
            gs_alv-desc_camp_e = text-953.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-city_no <> ls_vendors_detail-central_data-address-postal-data-city_no.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'CITY_NO'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-city_no.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-city_no.
            gs_alv-desc_camp_e = text-954.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-distrct_no <> ls_vendors_detail-central_data-address-postal-data-distrct_no.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'DISTRCT_NO'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-distrct_no.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-distrct_no.
            gs_alv-desc_camp_e = text-955.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-chckstatus <> ls_vendors_detail-central_data-address-postal-data-chckstatus.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'CHCKSTATUS'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-chckstatus.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-chckstatus.
            gs_alv-desc_camp_e = text-956.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-regiogroup <> ls_vendors_detail-central_data-address-postal-data-regiogroup.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'REGIOGROUP'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-regiogroup.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-regiogroup.
            gs_alv-desc_camp_e = text-957.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-postl_cod1 <> ls_vendors_detail-central_data-address-postal-data-postl_cod1.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'POSTL_COD1'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-postl_cod1.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-postl_cod1.
            gs_alv-desc_camp_e = text-958.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-postl_cod2 <> ls_vendors_detail-central_data-address-postal-data-postl_cod2.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'POSTL_COD2'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-postl_cod2.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-postl_cod2.
            gs_alv-desc_camp_e = text-903.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-postl_cod3 <> ls_vendors_detail-central_data-address-postal-data-postl_cod3.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'POSTL_COD3'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-postl_cod3.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-postl_cod3.
            gs_alv-desc_camp_e = text-904.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-pcode1_ext <> ls_vendors_detail-central_data-address-postal-data-pcode1_ext.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'PCODE1_EXT'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-pcode1_ext.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-pcode1_ext.
            gs_alv-desc_camp_e = text-905.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-pcode2_ext <> ls_vendors_detail-central_data-address-postal-data-pcode2_ext.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'PCODE2_EXT'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-pcode2_ext.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-pcode2_ext.
            gs_alv-desc_camp_e = text-906.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-pcode3_ext <> ls_vendors_detail-central_data-address-postal-data-pcode3_ext.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'PCODE3_EXT'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-pcode3_ext.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-pcode3_ext.
            gs_alv-desc_camp_e = text-907.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-po_box <> ls_vendors_detail-central_data-address-postal-data-po_box.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'PO_BOX'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-po_box.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-po_box.
            gs_alv-desc_camp_e = text-908.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-po_w_o_no <> ls_vendors_detail-central_data-address-postal-data-po_w_o_no.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'PO_W_O_NO'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-po_w_o_no.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-po_w_o_no.
            gs_alv-desc_camp_e = text-909.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          IF ls_customer_detail-central_data-address-postal-data-po_box_cit <> ls_vendors_detail-central_data-address-postal-data-po_box_cit.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'PO_BOX_CIT'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-po_box_cit.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-po_box_cit.
            gs_alv-desc_camp_e = text-910.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-pboxcit_no <> ls_vendors_detail-central_data-address-postal-data-pboxcit_no.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'PBOXCIT_NO'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-pboxcit_no.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-pboxcit_no.
            gs_alv-desc_camp_e = text-911.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-po_box_reg <> ls_vendors_detail-central_data-address-postal-data-po_box_reg.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'PO_BOX_REG'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-po_box_reg.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-po_box_reg.
            gs_alv-desc_camp_e = text-912.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-pobox_ctry <> ls_vendors_detail-central_data-address-postal-data-pobox_ctry.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'POBOX_CTRY'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-pobox_ctry.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-pobox_ctry.
            gs_alv-desc_camp_e = text-913.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-po_ctryiso <> ls_vendors_detail-central_data-address-postal-data-po_ctryiso.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'PO_CTRYISO'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-po_ctryiso.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-po_ctryiso.
            gs_alv-desc_camp_e = text-914.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-deliv_dis <> ls_vendors_detail-central_data-address-postal-data-deliv_dis.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'DELIV_DIS'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-deliv_dis.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-deliv_dis.
            gs_alv-desc_camp_e = text-915.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-transpzone <> ls_vendors_detail-central_data-address-postal-data-transpzone.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'TRANSPZONE'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-transpzone.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-transpzone.
            gs_alv-desc_camp_e = text-916.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-street <> ls_vendors_detail-central_data-address-postal-data-street.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'STREET'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-street.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-street.
            gs_alv-desc_camp_e = text-917.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-street_no <> ls_vendors_detail-central_data-address-postal-data-street_no.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'STREET_NO'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-street_no.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-street_no.
            gs_alv-desc_camp_e = text-918.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-str_abbr <> ls_vendors_detail-central_data-address-postal-data-str_abbr.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'STR_ABBR'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-str_abbr.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-str_abbr.
            gs_alv-desc_camp_e = text-919.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-house_no <> ls_vendors_detail-central_data-address-postal-data-house_no.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'HOUSE_NO'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-house_no.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-house_no.
            gs_alv-desc_camp_e = text-920.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-house_no2 <> ls_vendors_detail-central_data-address-postal-data-house_no2.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'HOUSE_NO2'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-house_no2.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-house_no2.
            gs_alv-desc_camp_e = text-921.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-house_no3 <> ls_vendors_detail-central_data-address-postal-data-house_no3.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'HOUSE_NO3'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-house_no3.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-house_no3.
            gs_alv-desc_camp_e = text-922.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.

          IF ls_customer_detail-central_data-address-postal-data-str_suppl1 <> ls_vendors_detail-central_data-address-postal-data-str_suppl1.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'STR_SUPPL1'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-str_suppl1.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-str_suppl1.
            gs_alv-desc_camp_e = text-923.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          IF ls_customer_detail-central_data-address-postal-data-str_suppl2 <> ls_vendors_detail-central_data-address-postal-data-str_suppl2.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'STR_SUPPL2'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-str_suppl2.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-str_suppl2.
            gs_alv-desc_camp_e = text-924.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          IF ls_customer_detail-central_data-address-postal-data-str_suppl3 <> ls_vendors_detail-central_data-address-postal-data-str_suppl3.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'STR_SUPPL3'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-str_suppl3.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-str_suppl3.
            gs_alv-desc_camp_e = text-925.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          IF ls_customer_detail-central_data-address-postal-data-location <> ls_vendors_detail-central_data-address-postal-data-location.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'LOCATION'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-location.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-location.
            gs_alv-desc_camp_e = text-926.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          IF ls_customer_detail-central_data-address-postal-data-building <> ls_vendors_detail-central_data-address-postal-data-building.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'BUILDING'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-building.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-building.
            gs_alv-desc_camp_e = text-927.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          IF ls_customer_detail-central_data-address-postal-data-floor <> ls_vendors_detail-central_data-address-postal-data-floor.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'FLOOR'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-floor.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-floor.
            gs_alv-desc_camp_e = text-928.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          IF ls_customer_detail-central_data-address-postal-data-room_no <> ls_vendors_detail-central_data-address-postal-data-room_no.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'ROOM_NO'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-room_no.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-room_no.
            gs_alv-desc_camp_e = text-929.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          IF ls_customer_detail-central_data-address-postal-data-country <> ls_vendors_detail-central_data-address-postal-data-country.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'COUNTRY'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-country.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-country.
            gs_alv-desc_camp_e = text-930.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          IF ls_customer_detail-central_data-address-postal-data-countryiso <> ls_vendors_detail-central_data-address-postal-data-countryiso.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'COUNTRYISO'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-countryiso.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-countryiso.
            gs_alv-desc_camp_e = text-931.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          IF ls_customer_detail-central_data-address-postal-data-langu <> ls_vendors_detail-central_data-address-postal-data-langu.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'LANGU'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-langu.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-langu.
            gs_alv-desc_camp_e = text-932.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          IF ls_customer_detail-central_data-address-postal-data-langu_iso <> ls_vendors_detail-central_data-address-postal-data-langu_iso.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'LANGU_ISO'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-langu_iso.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-langu_iso.
            gs_alv-desc_camp_e = text-933.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          IF ls_customer_detail-central_data-address-postal-data-region <> ls_vendors_detail-central_data-address-postal-data-region.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'REGION'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-region.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-region.
            gs_alv-desc_camp_e = text-934.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          IF ls_customer_detail-central_data-address-postal-data-sort1 <> ls_vendors_detail-central_data-address-postal-data-sort1.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'SORT1'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-sort1.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-sort1.
            gs_alv-desc_camp_e = text-935.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          IF ls_customer_detail-central_data-address-postal-data-sort2 <> ls_vendors_detail-central_data-address-postal-data-sort2.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'SORT2'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-sort2.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-sort2.
            gs_alv-desc_camp_e = text-936.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          IF ls_customer_detail-central_data-address-postal-data-extens_1 <> ls_vendors_detail-central_data-address-postal-data-extens_1.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'EXTENS_1'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-extens_1.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-extens_1.
            gs_alv-desc_camp_e = text-937.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          IF ls_customer_detail-central_data-address-postal-data-extens_2 <> ls_vendors_detail-central_data-address-postal-data-extens_2.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'EXTENS_2'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-extens_2.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-extens_2.
            gs_alv-desc_camp_e = text-938.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          IF ls_customer_detail-central_data-address-postal-data-time_zone <> ls_vendors_detail-central_data-address-postal-data-time_zone.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'TIME_ZONE'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-time_zone.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-time_zone.
            gs_alv-desc_camp_e = text-939.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          IF ls_customer_detail-central_data-address-postal-data-taxjurcode <> ls_vendors_detail-central_data-address-postal-data-taxjurcode.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'TAXJURCODE'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-taxjurcode.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-taxjurcode.
            gs_alv-desc_camp_e = text-940.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          IF ls_customer_detail-central_data-address-postal-data-address_id <> ls_vendors_detail-central_data-address-postal-data-address_id.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'ADDRESS_ID'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-address_id.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-address_id.
            gs_alv-desc_camp_e = text-941.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
** Del seidor 21.12.2020
** Eliminamos el chequeo de idioma de creación porque no nos interesa
*            IF ls_customer_detail-central_data-address-postal-data-langu_cr <> ls_vendors_detail-central_data-address-postal-data-langu_cr.
*              CLEAR gs_alv.
*              gs_alv-kunnr = gs_kna1-kunnr.
*              gs_alv-lifnr = gs_kna1-lifnr.
*              gs_alv-clilfa1 = cli_lfa1.
*              gs_alv-provlfa1 = pro_lfa1.
*              gs_alv-campo_erroneo = 'LANGU_CR'.
*              gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-langu_cr.
*              gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-langu_cr.
*              gs_alv-desc_camp_e = 'Idioma original al crear registro de direcciones'.
*              gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
*              gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
*              APPEND gs_alv TO gt_alv.
*            ENDIF.
*            IF ls_customer_detail-central_data-address-postal-data-langucriso <> ls_vendors_detail-central_data-address-postal-data-langucriso.
*              CLEAR gs_alv.
*              gs_alv-kunnr = gs_kna1-kunnr.
*              gs_alv-lifnr = gs_kna1-lifnr.
*              gs_alv-clilfa1 = cli_lfa1.
*              gs_alv-provlfa1 = pro_lfa1.
*              gs_alv-campo_erroneo = 'LANGUCRISO'.
*              gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-langucriso.
*              gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-langucriso.
*              gs_alv-desc_camp_e = 'Código de idioma SAP de dos cifras'.
*              gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
*              gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
*              APPEND gs_alv TO gt_alv.
*            ENDIF.
** Fin Del seidor 21.12.2020
          IF ls_customer_detail-central_data-address-postal-data-comm_type <> ls_vendors_detail-central_data-address-postal-data-comm_type.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'COMM_TYPE'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-comm_type.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-comm_type.
            gs_alv-desc_camp_e = text-942.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          IF ls_customer_detail-central_data-address-postal-data-addr_group <> ls_vendors_detail-central_data-address-postal-data-addr_group.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'ADDR_GROUP'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-addr_group.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-addr_group.
            gs_alv-desc_camp_e = text-943.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          IF ls_customer_detail-central_data-address-postal-data-home_city <> ls_vendors_detail-central_data-address-postal-data-home_city.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'HOME_CITY'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-home_city.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-home_city.
            gs_alv-desc_camp_e = text-961.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          IF ls_customer_detail-central_data-address-postal-data-homecityno <> ls_vendors_detail-central_data-address-postal-data-homecityno.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'HOMECITYNO'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-homecityno.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-homecityno.
            gs_alv-desc_camp_e = text-962.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          IF ls_customer_detail-central_data-address-postal-data-dont_use_s <> ls_vendors_detail-central_data-address-postal-data-dont_use_s.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'DONT_USE_S'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-dont_use_s.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-dont_use_s.
            gs_alv-desc_camp_e = text-963.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          IF ls_customer_detail-central_data-address-postal-data-dont_use_p <> ls_vendors_detail-central_data-address-postal-data-dont_use_p.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'DONT_USE_P'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-dont_use_p.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-dont_use_p.
            gs_alv-desc_camp_e = text-964.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          IF ls_customer_detail-central_data-address-postal-data-po_box_lobby <> ls_vendors_detail-central_data-address-postal-data-po_box_lobby.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'PO_BOX_LOBBY'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-po_box_lobby.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-po_box_lobby.
            gs_alv-desc_camp_e = text-965.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          IF ls_customer_detail-central_data-address-postal-data-deli_serv_type <> ls_vendors_detail-central_data-address-postal-data-deli_serv_type.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'DELI_SERV_TYPE'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-deli_serv_type.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-deli_serv_type.
            gs_alv-desc_camp_e = text-966.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          IF ls_customer_detail-central_data-address-postal-data-deli_serv_number <> ls_vendors_detail-central_data-address-postal-data-deli_serv_number.
            CLEAR gs_alv.
            gs_alv-kunnr = gs_kna1-kunnr.
            gs_alv-lifnr = gs_kna1-lifnr.
            gs_alv-clilfa1 = cli_lfa1.
            gs_alv-provlfa1 = pro_lfa1.
            gs_alv-campo_erroneo = 'DELI_SERV_NUMBER'.
            gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-deli_serv_number.
            gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-deli_serv_number.
            gs_alv-desc_camp_e = text-967.
            gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
            gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
            APPEND gs_alv TO gt_alv.
          ENDIF.
          "INI MODU 04.08.2023 08:29:53 SAPECC_to_S4HANA < en ESTAMP la version de BAPIAD1VL no contiene los campos de COUNTY y TOWNSHIP >
*            IF ls_customer_detail-central_data-address-postal-data-county_code <> ls_vendors_detail-central_data-address-postal-data-county_code.
*              CLEAR gs_alv.
*              gs_alv-kunnr = gs_kna1-kunnr.
*              gs_alv-lifnr = gs_kna1-lifnr.
*              gs_alv-clilfa1 = cli_lfa1.
*              gs_alv-provlfa1 = pro_lfa1.
*              gs_alv-campo_erroneo = 'COUNTY_CODE'.
*              gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-county_code.
*              gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-county_code.
*              gs_alv-desc_camp_e = TEXT-968.
*              gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
*              gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
*              APPEND gs_alv TO gt_alv.
*            ENDIF.
*            IF ls_customer_detail-central_data-address-postal-data-county <> ls_vendors_detail-central_data-address-postal-data-county.
*              CLEAR gs_alv.
*              gs_alv-kunnr = gs_kna1-kunnr.
*              gs_alv-lifnr = gs_kna1-lifnr.
*              gs_alv-clilfa1 = cli_lfa1.
*              gs_alv-provlfa1 = pro_lfa1.
*              gs_alv-campo_erroneo = 'COUNTY'.
*              gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-county.
*              gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-county.
*              gs_alv-desc_camp_e = TEXT-969.
*              gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
*              gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
*              APPEND gs_alv TO gt_alv.
*            ENDIF.
*
*            IF ls_customer_detail-central_data-address-postal-data-township_code <> ls_vendors_detail-central_data-address-postal-data-township_code.
*              CLEAR gs_alv.
*              gs_alv-kunnr = gs_kna1-kunnr.
*              gs_alv-lifnr = gs_kna1-lifnr.
*              gs_alv-clilfa1 = cli_lfa1.
*              gs_alv-provlfa1 = pro_lfa1.
*              gs_alv-campo_erroneo = 'TOWNSHIP_CODE'.
*              gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-township_code.
*              gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-township_code.
*              gs_alv-desc_camp_e = TEXT-970.
*              gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
*              gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
*              APPEND gs_alv TO gt_alv.
*            ENDIF.
*
*            IF ls_customer_detail-central_data-address-postal-data-township <> ls_vendors_detail-central_data-address-postal-data-township.
*              CLEAR gs_alv.
*              gs_alv-kunnr = gs_kna1-kunnr.
*              gs_alv-lifnr = gs_kna1-lifnr.
*              gs_alv-clilfa1 = cli_lfa1.
*              gs_alv-provlfa1 = pro_lfa1.
*              gs_alv-campo_erroneo = 'TOWNSHIP'.
*              gs_alv-cli_valor = ls_customer_detail-central_data-address-postal-data-township.
**              gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-township_code.
*              gs_alv-prov_valor = ls_vendors_detail-central_data-address-postal-data-township.
*              gs_alv-desc_camp_e = TEXT-971.
*              gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
*              gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
*              APPEND gs_alv TO gt_alv.
*            ENDIF.
          "FIN MODU 04.08.2023 08:29:53 SAPECC_to_S4HANA
          CLEAR: wal_phone_customer,
                 wal_phone_vendor,
                 wal_fax_customer,
                 wal_fax_vendor,
                 wal_smtp_customer,
                 wal_smtp_vendor,
                 wal_comments_customer,
                 wal_comments_vendor.

          CLEAR: ls_contador_customer, ls_contador_vendors.
          DESCRIBE TABLE ls_customer_detail-central_data-address-communication-phone-phone LINES ls_contador_customer.
          DESCRIBE TABLE ls_vendors_detail-central_data-address-communication-phone-phone   LINES ls_contador_vendors.

          CLEAR: wal_mob_phone_customer,
                 wal_mob_phone_vendor.
          CLEAR: wal_phone_customer,
                 wal_phone_vendor,
                 wa_dentro,
                 wal_comments_customer,
                 wal_comments_vendor.
*        IF ls_contador_customer > ls_contador_vendors. "NEW 20.11.2023
          DATA var1 TYPE ad_flgmob.
          DATA buscar.
          LOOP AT ls_customer_detail-central_data-address-communication-phone-phone INTO wal_phone_customer.
            CLEAR wal_phone_vendor.
            CLEAR var1.
            CLEAR buscar.
            IF wal_phone_customer-contact-data-r_3_user = space.
              var1 = '1'.
              buscar = 'X'.
            ELSEIF wal_phone_customer-contact-data-r_3_user = '1'.
              var1 = space.
              buscar = 'X'.
            ELSEIF wal_phone_customer-contact-data-r_3_user = '2'.
              var1 = '3'.
              buscar = 'X'.
            ELSEIF wal_phone_customer-contact-data-r_3_user = '3'.
              var1 = '2'.
              buscar = 'X'.
            ENDIF.
            IF buscar = 'X'.
              LOOP AT ls_vendors_detail-central_data-address-communication-phone-phone INTO wal_phone_vendor
                                                                                      WHERE contact-data-telephone = wal_phone_customer-contact-data-telephone
                                                                                        AND ( contact-data-r_3_user = wal_phone_customer-contact-data-r_3_user
                                                                                         OR contact-data-r_3_user = var1 ).  "VRS 26.06.2024
              ENDLOOP.
            ELSE.
              LOOP AT ls_vendors_detail-central_data-address-communication-phone-phone INTO wal_phone_vendor
                                                                                      WHERE contact-data-telephone = wal_phone_customer-contact-data-telephone
                                                                                        AND contact-data-r_3_user = wal_phone_customer-contact-data-r_3_user.  "VRS 26.06.2024
              ENDLOOP.
            ENDIF.
            CLEAR wa_dentro.
            IF sy-subrc <> 0.
              CLEAR gs_alv.
              wa_dentro = '1'.
              gs_alv-kunnr = gs_kna1-kunnr.
              gs_alv-lifnr = gs_kna1-lifnr.
              gs_alv-clilfa1 = cli_lfa1.
              gs_alv-provlfa1 = pro_lfa1.
              gs_alv-campo_erroneo = 'TELEPHONE'.
              gs_alv-cli_valor = wal_phone_customer-contact-data-telephone.
              gs_alv-prov_valor = wal_phone_vendor-contact-data-telephone.
              IF wal_phone_customer-contact-data-r_3_user = '2' OR wal_phone_customer-contact-data-r_3_user = '3'.  "VRS 26.06.2024
                gs_alv-desc_camp_e = text-989.
              ELSE.
                gs_alv-desc_camp_e = text-972.
              ENDIF.
              gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
              gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
              APPEND gs_alv TO gt_alv.

              CLEAR: wal_comments_customer.
              READ TABLE wal_phone_customer-remark-remarks INTO wal_comments_customer INDEX 1.
              IF wal_comments_customer-data-comm_notes IS NOT INITIAL.                 "NEW 20.11.2023
                CLEAR gs_alv.
                gs_alv-kunnr = gs_kna1-kunnr.
                gs_alv-lifnr = gs_kna1-lifnr.
                gs_alv-clilfa1 = cli_lfa1.
                gs_alv-provlfa1 = pro_lfa1.
                gs_alv-campo_erroneo = 'REMARKS'.
                gs_alv-cli_valor = wal_comments_customer-data-comm_notes.
                gs_alv-prov_valor = wal_comments_vendor-data-comm_notes.
                CONCATENATE 'Comentarios Teléfono' wal_phone_customer-contact-data-telephone INTO gs_alv-desc_camp_e SEPARATED BY space.
*                  gs_alv-desc_camp_e = 'Comentarios Teléfono'.
                gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
                gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
                APPEND gs_alv TO gt_alv.
              ENDIF.
            ELSE.
              CONTINUE.
            ENDIF.

*            READ TABLE ls_customer_detail-central_data-address-communication-phone-phone INTO wal_mob_phone_vendor
*                                                                                       WITH KEY contact-data-tel_no = wal_phone_vendor-contact-data-tel_no.
            IF wa_dentro NE '1'.
*              IF sy-subrc EQ 0.    "VRS 26.06.2024: Remplazo READ TABLE por el IF.
              IF wal_phone_vendor-contact-data-tel_no <> wal_phone_customer-contact-data-tel_no.
                CLEAR gs_alv.
                gs_alv-kunnr = gs_kna1-kunnr.
                gs_alv-lifnr = gs_kna1-lifnr.
                gs_alv-clilfa1 = cli_lfa1.
                gs_alv-provlfa1 = pro_lfa1.
                gs_alv-campo_erroneo = 'TEL_NO'.
                gs_alv-cli_valor = wal_phone_customer-contact-data-tel_no.
                gs_alv-prov_valor = wal_phone_vendor-contact-data-tel_no.
                IF wal_phone_customer-contact-data-r_3_user = '2' OR wal_phone_customer-contact-data-r_3_user = '3'.  "VRS 26.06.2024
                  gs_alv-desc_camp_e = text-989.
                ELSE.
                  gs_alv-desc_camp_e = text-972.
                ENDIF.
                gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
                gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
                APPEND gs_alv TO gt_alv.
              ENDIF.
*              ELSE.
*                CLEAR gs_alv.
*                gs_alv-kunnr = gs_kna1-kunnr.
*                gs_alv-lifnr = gs_kna1-lifnr.
*                gs_alv-clilfa1 = cli_lfa1.
*                gs_alv-provlfa1 = pro_lfa1.
*                gs_alv-campo_erroneo = 'TEL_NO'.
*                gs_alv-cli_valor = wal_phone_customer-contact-data-tel_no.
*                gs_alv-prov_valor = ''.
*                gs_alv-desc_camp_e = text-972.
*                gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
*                gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
*                APPEND gs_alv TO gt_alv.
*              ENDIF.
            ENDIF.


          ENDLOOP.

*            LOOP AT ls_customer_detail-central_data-address-communication-phone-phone INTO wal_mob_phone_customer.
*              READ TABLE ls_vendors_detail-central_data-address-communication-phone-phone INTO wal_mob_phone_vendor
*                                                                                       WITH KEY contact-data-TEL_NO = wal_mob_phone_customer-contact-data-TEL_NO.
**              IF wal_mob_phone_customer-CONTACT-DATA-TELEPHONE IS INITIAL.
*                IF sy-SUBRC <> 0.
*                  CLEAR gs_alv.
*                  gs_alv-kunnr = gs_kna1-kunnr.
*                  gs_alv-lifnr = gs_kna1-lifnr.
*                  gs_alv-clilfa1 = cli_lfa1.
*                  gs_alv-provlfa1 = pro_lfa1.
*                  gs_alv-campo_erroneo = 'TEL_NO'.
*                  gs_alv-cli_valor = wal_mob_phone_customer-contact-data-TEL_NO.
*                  gs_alv-prov_valor = ''.
*                  gs_alv-desc_camp_e = TEXT-972.
*                  gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
*                  gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
*                  APPEND gs_alv TO gt_alv.
*                ENDIF.
**              ENDIF.
*
*            ENDLOOP.
          LOOP AT ls_customer_detail-central_data-address-communication-phone-phone INTO wal_phone_customer.
            LOOP AT wal_phone_customer-remark-remarks INTO wal_comments_customer.
              LOOP AT ls_vendors_detail-central_data-address-communication-phone-phone INTO wal_phone_vendor
                                                                                      WHERE contact-data-telephone = wal_phone_customer-contact-data-telephone.
                LOOP AT wal_phone_vendor-remark-remarks INTO wal_comments_vendor WHERE data-comm_notes = wal_comments_customer-data-comm_notes.
                ENDLOOP.
                IF sy-subrc <> 0.
                  CLEAR gs_alv.
                  gs_alv-kunnr = gs_kna1-kunnr.
                  gs_alv-lifnr = gs_kna1-lifnr.
                  gs_alv-clilfa1 = cli_lfa1.
                  gs_alv-provlfa1 = pro_lfa1.
                  gs_alv-campo_erroneo = 'REMARKS'.
                  gs_alv-cli_valor = wal_comments_customer-data-comm_notes.
                  gs_alv-prov_valor = wal_comments_vendor-data-comm_notes.
                  gs_alv-desc_camp_e = text-973.
                  gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
                  gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
                  APPEND gs_alv TO gt_alv.
                ENDIF.
              ENDLOOP.
            ENDLOOP.
          ENDLOOP.
*          ELSE.
          CLEAR: wal_phone_customer,
                 wal_phone_vendor.
          CLEAR: wal_phone_customer,
                 wal_phone_vendor,
                 wal_mob_phone_customer,
                 wal_mob_phone_vendor,
                 wal_comments_customer,
                 wal_comments_vendor.
          LOOP AT ls_vendors_detail-central_data-address-communication-phone-phone INTO wal_phone_vendor.
            CLEAR wal_phone_customer.
            CLEAR var1.
            CLEAR buscar.
            IF wal_phone_vendor-contact-data-r_3_user = space.
              var1 = '1'.
              buscar = 'X'.
            ELSEIF wal_phone_vendor-contact-data-r_3_user = '1'.
              var1 = space.
              buscar = 'X'.
            ELSEIF wal_phone_vendor-contact-data-r_3_user = '2'.
              var1 = '3'.
              buscar = 'X'.
            ELSEIF wal_phone_vendor-contact-data-r_3_user = '3'.
              var1 = '2'.
              buscar = 'X'.
            ENDIF.
            IF buscar = 'X'.
              LOOP AT ls_customer_detail-central_data-address-communication-phone-phone INTO wal_phone_customer
                                                                        WHERE contact-data-telephone = wal_phone_vendor-contact-data-telephone
                                                                          AND ( contact-data-r_3_user = wal_phone_vendor-contact-data-r_3_user
                                                                            OR contact-data-r_3_user = var1 ).  "VRS 26.06.2024
              ENDLOOP.
            ELSE.
              LOOP AT ls_customer_detail-central_data-address-communication-phone-phone INTO wal_phone_customer
                                                                                      WHERE contact-data-telephone = wal_phone_vendor-contact-data-telephone
                                                                                        AND contact-data-r_3_user = wal_phone_vendor-contact-data-r_3_user.  "VRS 26.06.2024
              ENDLOOP.
            ENDIF.
            CLEAR wa_dentro.
            IF sy-subrc <> 0.
              wa_dentro = '1'.
              CLEAR gs_alv.
              gs_alv-kunnr = gs_kna1-kunnr.
              gs_alv-lifnr = gs_kna1-lifnr.
              gs_alv-clilfa1 = cli_lfa1.
              gs_alv-provlfa1 = pro_lfa1.
              gs_alv-campo_erroneo = 'TELEPHONE'.
              gs_alv-cli_valor = wal_phone_customer-contact-data-telephone.
              gs_alv-prov_valor = wal_phone_vendor-contact-data-telephone.
              IF wal_phone_vendor-contact-data-r_3_user = '2' OR wal_phone_vendor-contact-data-r_3_user = '3'.  "VRS 26.06.2024
                gs_alv-desc_camp_e = text-989.
              ELSE.
                gs_alv-desc_camp_e = text-972.
              ENDIF.
              gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
              gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
              APPEND gs_alv TO gt_alv.

              CLEAR: wal_comments_vendor.
              READ TABLE wal_phone_vendor-remark-remarks INTO wal_comments_vendor INDEX 1.
              IF wal_comments_vendor-data-comm_notes IS NOT INITIAL.                 "NEW 20.11.2023
                CLEAR gs_alv.
                gs_alv-kunnr = gs_kna1-kunnr.
                gs_alv-lifnr = gs_kna1-lifnr.
                gs_alv-clilfa1 = cli_lfa1.
                gs_alv-provlfa1 = pro_lfa1.
                gs_alv-campo_erroneo = 'REMARKS'.
                gs_alv-cli_valor = wal_comments_customer-data-comm_notes.
                gs_alv-prov_valor = wal_comments_vendor-data-comm_notes.
                CONCATENATE 'Comentarios Teléfono' wal_phone_vendor-contact-data-telephone INTO gs_alv-desc_camp_e SEPARATED BY space.
*                  gs_alv-desc_camp_e = 'Comentarios Teléfono'.
                gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
                gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
                APPEND gs_alv TO gt_alv.
              ENDIF.
            ELSE.
*              READ TABLE ls_customer_detail-central_data-address-communication-phone-phone INTO wal_mob_phone_vendor
*                                                                                     WITH KEY contact-data-tel_no = wal_phone_vendor-contact-data-tel_no.
*              IF sy-subrc EQ 0.  "VRS 26.06.2024: Remplazo READ TABLE por el IF.
              IF wal_phone_vendor-contact-data-tel_no <> wal_phone_customer-contact-data-tel_no.
                CLEAR gs_alv.
                gs_alv-kunnr = gs_kna1-kunnr.
                gs_alv-lifnr = gs_kna1-lifnr.
                gs_alv-clilfa1 = cli_lfa1.
                gs_alv-provlfa1 = pro_lfa1.
                gs_alv-campo_erroneo = 'TEL_NO'.
                gs_alv-cli_valor = wal_phone_customer-contact-data-tel_no.
                gs_alv-prov_valor = wal_phone_vendor-contact-data-tel_no.
                IF wal_phone_vendor-contact-data-r_3_user = '2' OR wal_phone_vendor-contact-data-r_3_user = '3'.  "VRS 26.06.2024
                  gs_alv-desc_camp_e = text-989.
                ELSE.
                  gs_alv-desc_camp_e = text-972.
                ENDIF.
                gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
                gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
                APPEND gs_alv TO gt_alv.
              ENDIF.
*              ELSE.
*                CLEAR gs_alv.
*                gs_alv-kunnr = gs_kna1-kunnr.
*                gs_alv-lifnr = gs_kna1-lifnr.
*                gs_alv-clilfa1 = cli_lfa1.
*                gs_alv-provlfa1 = pro_lfa1.
*                gs_alv-campo_erroneo = 'TEL_NO'.
*                gs_alv-cli_valor = wal_phone_customer-contact-data-tel_no.
*                gs_alv-prov_valor = ''.
*                gs_alv-desc_camp_e = text-972.
*                gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
*                gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
*                APPEND gs_alv TO gt_alv.
*              ENDIF.
            ENDIF.
          ENDLOOP.

*            LOOP AT ls_vendors_detail-central_data-address-communication-phone-phone INTO wal_mob_phone_vendor.
*              READ TABLE ls_customer_detail-central_data-address-communication-phone-phone INTO wal_mob_phone_customer
*                                                                                       WITH KEY contact-data-TEL_NO = wal_mob_phone_vendor-contact-data-TEL_NO.
**              IF wal_mob_phone_customer-CONTACT-DATA-TELEPHONE IS INITIAL.
*                IF sy-SUBRC <> 0.
*                  CLEAR gs_alv.
*                  gs_alv-kunnr = gs_kna1-kunnr.
*                  gs_alv-lifnr = gs_kna1-lifnr.
*                  gs_alv-clilfa1 = cli_lfa1.
*                  gs_alv-provlfa1 = pro_lfa1.
*                  gs_alv-campo_erroneo = 'TEL_NO'.
*                  gs_alv-cli_valor = ''.
*                  gs_alv-prov_valor = wal_mob_phone_vendor-contact-data-TEL_NO.
*                  gs_alv-desc_camp_e = TEXT-972.
*                  gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
*                  gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
*                  APPEND gs_alv TO gt_alv.
*                ENDIF.
**              ENDIF.
*
*            ENDLOOP.
          LOOP AT ls_vendors_detail-central_data-address-communication-phone-phone INTO wal_phone_vendor.
            LOOP AT wal_phone_vendor-remark-remarks INTO wal_comments_vendor.
              LOOP AT ls_customer_detail-central_data-address-communication-phone-phone INTO wal_phone_customer
                                                                                      WHERE contact-data-telephone = wal_phone_vendor-contact-data-telephone.
                LOOP AT wal_phone_customer-remark-remarks INTO wal_comments_customer WHERE data-comm_notes = wal_comments_vendor-data-comm_notes.
                ENDLOOP.
                IF sy-subrc <> 0.
                  CLEAR gs_alv.
                  gs_alv-kunnr = gs_kna1-kunnr.
                  gs_alv-lifnr = gs_kna1-lifnr.
                  gs_alv-clilfa1 = cli_lfa1.
                  gs_alv-provlfa1 = pro_lfa1.
                  gs_alv-campo_erroneo = 'REMARKS'.
                  gs_alv-cli_valor = wal_comments_customer-data-comm_notes.
                  gs_alv-prov_valor = wal_comments_vendor-data-comm_notes.
                  gs_alv-desc_camp_e = text-973.
                  gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
                  gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
                  APPEND gs_alv TO gt_alv.
                ENDIF.
              ENDLOOP.
            ENDLOOP.
          ENDLOOP.
*          ENDIF.

* FAX
          CLEAR: ls_contador_customer, ls_contador_vendors.
          DESCRIBE TABLE ls_customer_detail-central_data-address-communication-fax-fax LINES ls_contador_customer.
          DESCRIBE TABLE ls_vendors_detail-central_data-address-communication-fax-fax LINES ls_contador_vendors.

          CLEAR: wal_fax_customer,
                 wal_fax_vendor.
          CLEAR: wal_fax_customer,
                 wal_fax_vendor,
                 wal_comments_customer,
                 wal_comments_vendor.
*          IF ls_contador_customer > ls_contador_vendors.
          LOOP AT ls_customer_detail-central_data-address-communication-fax-fax INTO wal_fax_customer.
            LOOP AT ls_vendors_detail-central_data-address-communication-fax-fax INTO wal_fax_vendor
                                                                                WHERE contact-data-fax = wal_fax_customer-contact-data-fax.
            ENDLOOP.
            IF sy-subrc <> 0.
              CLEAR gs_alv.
              gs_alv-kunnr = gs_kna1-kunnr.
              gs_alv-lifnr = gs_kna1-lifnr.
              gs_alv-clilfa1 = cli_lfa1.
              gs_alv-provlfa1 = pro_lfa1.
              gs_alv-campo_erroneo = 'FAX'.
              gs_alv-cli_valor = wal_fax_customer-contact-data-fax.
              gs_alv-prov_valor = wal_fax_vendor-contact-data-fax.
              gs_alv-desc_camp_e = 'Fax'.
              gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
              gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
              APPEND gs_alv TO gt_alv.


              CLEAR: wal_comments_customer.
              READ TABLE wal_fax_customer-remark-remarks INTO wal_comments_customer INDEX 1.
              IF wal_comments_customer-data-comm_notes IS NOT INITIAL.
                CLEAR gs_alv.
                gs_alv-kunnr = gs_kna1-kunnr.
                gs_alv-lifnr = gs_kna1-lifnr.
                gs_alv-clilfa1 = cli_lfa1.
                gs_alv-provlfa1 = pro_lfa1.
                gs_alv-campo_erroneo = 'REMARKS'.
                gs_alv-cli_valor = wal_comments_customer-data-comm_notes.
                gs_alv-prov_valor = wal_comments_vendor-data-comm_notes.
                CONCATENATE 'Comentarios FAX' wal_fax_customer-contact-data-fax INTO gs_alv-desc_camp_e SEPARATED BY space.
*                  gs_alv-desc_camp_e = 'Comentarios FAX'.
                gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
                gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
                APPEND gs_alv TO gt_alv.
              ENDIF.
            ELSE.
              CONTINUE.
            ENDIF.
          ENDLOOP.
          LOOP AT ls_customer_detail-central_data-address-communication-fax-fax INTO wal_fax_customer.
            LOOP AT wal_fax_customer-remark-remarks INTO wal_comments_customer.
              LOOP AT ls_vendors_detail-central_data-address-communication-fax-fax INTO wal_fax_vendor
                                                                                      WHERE contact-data-fax = wal_fax_customer-contact-data-fax.
                LOOP AT wal_fax_vendor-remark-remarks INTO wal_comments_vendor WHERE data-comm_notes = wal_comments_customer-data-comm_notes.
                ENDLOOP.
                IF sy-subrc <> 0.
                  CLEAR gs_alv.
                  gs_alv-kunnr = gs_kna1-kunnr.
                  gs_alv-lifnr = gs_kna1-lifnr.
                  gs_alv-clilfa1 = cli_lfa1.
                  gs_alv-provlfa1 = pro_lfa1.
                  gs_alv-campo_erroneo = 'REMARKS'.
                  gs_alv-cli_valor = wal_comments_customer-data-comm_notes.
                  gs_alv-prov_valor = wal_comments_vendor-data-comm_notes.
                  CONCATENATE 'Comentarios FAX' wal_fax_customer-contact-data-fax INTO gs_alv-desc_camp_e SEPARATED BY space.
*                    gs_alv-desc_camp_e = 'Comentarios FAX'.
                  gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
                  gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
                  APPEND gs_alv TO gt_alv.
                ELSE.
                  CONTINUE.
                ENDIF.
              ENDLOOP.
            ENDLOOP.
          ENDLOOP.
*          ELSE.
          CLEAR: wal_fax_customer,
     wal_fax_vendor.
          CLEAR: wal_fax_customer,
                 wal_fax_vendor,
                 wal_comments_customer,
                 wal_comments_vendor.
          LOOP AT ls_vendors_detail-central_data-address-communication-fax-fax INTO wal_fax_vendor.
            CLEAR wal_fax_customer.
            LOOP AT ls_customer_detail-central_data-address-communication-fax-fax INTO wal_fax_customer
                                                                                WHERE contact-data-fax = wal_fax_vendor-contact-data-fax.
            ENDLOOP.
            IF sy-subrc <> 0.
              CLEAR gs_alv.
              gs_alv-kunnr = gs_kna1-kunnr.
              gs_alv-lifnr = gs_kna1-lifnr.
              gs_alv-clilfa1 = cli_lfa1.
              gs_alv-provlfa1 = pro_lfa1.
              gs_alv-campo_erroneo = 'FAX'.
              gs_alv-cli_valor = wal_fax_customer-contact-data-fax.
              gs_alv-prov_valor = wal_fax_vendor-contact-data-fax.
              gs_alv-desc_camp_e = 'Fax'.
              gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
              gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
              APPEND gs_alv TO gt_alv.

              CLEAR: wal_comments_vendor.
              READ TABLE wal_fax_vendor-remark-remarks INTO wal_comments_vendor INDEX 1.
              IF wal_comments_vendor-data-comm_notes IS NOT INITIAL.
                CLEAR gs_alv.
                gs_alv-kunnr = gs_kna1-kunnr.
                gs_alv-lifnr = gs_kna1-lifnr.
                gs_alv-clilfa1 = cli_lfa1.
                gs_alv-provlfa1 = pro_lfa1.
                gs_alv-campo_erroneo = 'REMARKS'.
                gs_alv-cli_valor = wal_comments_customer-data-comm_notes.
                gs_alv-prov_valor = wal_comments_vendor-data-comm_notes.
                CONCATENATE 'Comentarios FAX' wal_fax_vendor-contact-data-fax INTO gs_alv-desc_camp_e SEPARATED BY space.
*                  gs_alv-desc_camp_e = 'Comentarios FAX'.
                gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
                gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
                APPEND gs_alv TO gt_alv.
              ENDIF.
            ELSE.
              CONTINUE.
            ENDIF.
          ENDLOOP.
          LOOP AT ls_vendors_detail-central_data-address-communication-fax-fax INTO wal_fax_vendor.
            LOOP AT wal_fax_vendor-remark-remarks INTO wal_comments_vendor.
              LOOP AT ls_customer_detail-central_data-address-communication-fax-fax INTO wal_fax_customer
                                                                                      WHERE contact-data-fax = wal_fax_vendor-contact-data-fax.
                LOOP AT wal_fax_customer-remark-remarks INTO wal_comments_customer WHERE data-comm_notes = wal_comments_vendor-data-comm_notes.
                ENDLOOP.
                IF sy-subrc <> 0.
                  CLEAR gs_alv.
                  gs_alv-kunnr = gs_kna1-kunnr.
                  gs_alv-lifnr = gs_kna1-lifnr.
                  gs_alv-clilfa1 = cli_lfa1.
                  gs_alv-provlfa1 = pro_lfa1.
                  gs_alv-campo_erroneo = 'REMARKS'.
                  gs_alv-cli_valor = wal_comments_customer-data-comm_notes.
                  gs_alv-prov_valor = wal_comments_vendor-data-comm_notes.
                  CONCATENATE 'Comentarios FAX' wal_fax_vendor-contact-data-fax INTO gs_alv-desc_camp_e SEPARATED BY space.
*                    gs_alv-desc_camp_e = 'Comentarios FAX'.
                  gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
                  gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
                  APPEND gs_alv TO gt_alv.
                ELSE.
                  CONTINUE.
                ENDIF.
              ENDLOOP.
            ENDLOOP.
          ENDLOOP.
*          ENDIF.

* EMAIL
          CLEAR: ls_contador_customer, ls_contador_vendors.
          DESCRIBE TABLE ls_customer_detail-central_data-address-communication-smtp-smtp LINES ls_contador_customer.
          DESCRIBE TABLE ls_vendors_detail-central_data-address-communication-smtp-smtp LINES ls_contador_vendors.

          CLEAR: wal_smtp_customer,
                 wal_smtp_vendor.
          CLEAR: wal_smtp_customer,
                 wal_smtp_vendor,
                 wal_comments_customer,
                 wal_comments_vendor.
*          IF ls_contador_customer > ls_contador_vendors.
          LOOP AT ls_customer_detail-central_data-address-communication-smtp-smtp INTO wal_smtp_customer.
            LOOP AT ls_vendors_detail-central_data-address-communication-smtp-smtp INTO wal_smtp_vendor
                                                                                  WHERE contact-data-e_mail = wal_smtp_customer-contact-data-e_mail.
            ENDLOOP.
            IF sy-subrc <> 0.
              CLEAR gs_alv.
              gs_alv-kunnr = gs_kna1-kunnr.
              gs_alv-lifnr = gs_kna1-lifnr.
              gs_alv-clilfa1 = cli_lfa1.
              gs_alv-provlfa1 = pro_lfa1.
              gs_alv-campo_erroneo = 'SMTP'.
              gs_alv-cli_valor = wal_smtp_customer-contact-data-e_mail.
*                gs_alv-prov_valor = wal_smtp_vendor-contact-data-e_mail.
              gs_alv-prov_valor = ''.
              gs_alv-desc_camp_e = text-976.
              gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
              gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
              APPEND gs_alv TO gt_alv.
            ENDIF.
          ENDLOOP.
          LOOP AT ls_customer_detail-central_data-address-communication-smtp-smtp INTO wal_smtp_customer.
            LOOP AT wal_smtp_customer-remark-remarks INTO wal_comments_customer.
              LOOP AT ls_vendors_detail-central_data-address-communication-smtp-smtp INTO wal_smtp_vendor
                                                                                    WHERE contact-data-e_mail = wal_smtp_customer-contact-data-e_mail.
                LOOP AT wal_smtp_vendor-remark-remarks INTO wal_comments_vendor WHERE data-comm_notes = wal_comments_customer-data-comm_notes.
                ENDLOOP.
                IF sy-subrc <> 0.
                  CLEAR gs_alv.
                  gs_alv-kunnr = gs_kna1-kunnr.
                  gs_alv-lifnr = gs_kna1-lifnr.
                  gs_alv-clilfa1 = cli_lfa1.
                  gs_alv-provlfa1 = pro_lfa1.
                  gs_alv-campo_erroneo = 'REMARKS'.
                  gs_alv-cli_valor = wal_comments_customer-data-comm_notes.
                  gs_alv-prov_valor = wal_comments_vendor-data-comm_notes.
                  gs_alv-desc_camp_e = text-977.
                  gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
                  gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
                  APPEND gs_alv TO gt_alv.
                ENDIF.
              ENDLOOP.
            ENDLOOP.
          ENDLOOP.
*          ELSE.
          LOOP AT ls_vendors_detail-central_data-address-communication-smtp-smtp INTO wal_smtp_vendor.
            LOOP AT ls_customer_detail-central_data-address-communication-smtp-smtp INTO wal_smtp_customer
                                                                                  WHERE contact-data-e_mail = wal_smtp_vendor-contact-data-e_mail.
            ENDLOOP.
            IF sy-subrc <> 0.
              CLEAR gs_alv.
              gs_alv-kunnr = gs_kna1-kunnr.
              gs_alv-lifnr = gs_kna1-lifnr.
              gs_alv-clilfa1 = cli_lfa1.
              gs_alv-provlfa1 = pro_lfa1.
              gs_alv-campo_erroneo = 'SMTP'.
*                gs_alv-cli_valor = wal_smtp_customer-contact-data-e_mail.
              gs_alv-cli_valor = ''.
              gs_alv-prov_valor = wal_smtp_vendor-contact-data-e_mail.
              gs_alv-desc_camp_e = text-976.
              gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
              gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
              APPEND gs_alv TO gt_alv.
            ENDIF.
          ENDLOOP.
          LOOP AT ls_vendors_detail-central_data-address-communication-smtp-smtp INTO wal_smtp_vendor.
            LOOP AT wal_smtp_vendor-remark-remarks INTO wal_comments_vendor.
              LOOP AT ls_customer_detail-central_data-address-communication-smtp-smtp INTO wal_smtp_customer
                                                                                    WHERE contact-data-e_mail = wal_smtp_vendor-contact-data-e_mail.
                LOOP AT wal_smtp_customer-remark-remarks INTO wal_comments_customer WHERE data-comm_notes = wal_comments_vendor-data-comm_notes.
                ENDLOOP.
                IF sy-subrc <> 0.
                  CLEAR gs_alv.
                  gs_alv-kunnr = gs_kna1-kunnr.
                  gs_alv-lifnr = gs_kna1-lifnr.
                  gs_alv-clilfa1 = cli_lfa1.
                  gs_alv-provlfa1 = pro_lfa1.
                  gs_alv-campo_erroneo = 'REMARKS'.
                  gs_alv-cli_valor = wal_comments_customer-data-comm_notes.
                  gs_alv-prov_valor = wal_comments_vendor-data-comm_notes.
                  gs_alv-desc_camp_e = text-977.
                  gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
                  gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
                  APPEND gs_alv TO gt_alv.
                ENDIF.
              ENDLOOP.
            ENDLOOP.
          ENDLOOP.
*          ENDIF.
*          ENDIF.

*  Check Bank Data
          LOOP AT ls_vendors_detail-central_data-bankdetail-bankdetails INTO ls_vend_bankdetail.
            READ TABLE ls_customer_detail-central_data-bankdetail-bankdetails INTO ls_cust_bankdetail
            WITH KEY data_key-banks  = ls_vend_bankdetail-data_key-banks
                     data_key-bankl  = ls_vend_bankdetail-data_key-bankl
                     data_key-bankn  = ls_vend_bankdetail-data_key-bankn.
            wa_subrc = sy-subrc.
            IF sy-subrc = 0.
              IF ls_vend_bankdetail-data <> ls_cust_bankdetail-data.
                IF ls_vend_bankdetail-data-bkont <> ls_cust_bankdetail-data-bkont.
                  CLEAR gs_alv.
                  gs_alv-kunnr = gs_kna1-kunnr.
                  gs_alv-lifnr = gs_kna1-lifnr.
                  gs_alv-clilfa1 = cli_lfa1.
                  gs_alv-provlfa1 = pro_lfa1.
                  gs_alv-campo_erroneo = 'BKONT'.
                  gs_alv-cli_valor = ls_cust_bankdetail-data-bkont.
                  gs_alv-prov_valor = ls_vend_bankdetail-data-bkont.
                  gs_alv-desc_camp_e = text-978.
                  gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
                  gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
                  APPEND gs_alv TO gt_alv.
                ENDIF.
              ENDIF.
              IF ls_vend_bankdetail-data-bvtyp <> ls_cust_bankdetail-data-bvtyp.
                CLEAR gs_alv.
                gs_alv-kunnr = gs_kna1-kunnr.
                gs_alv-lifnr = gs_kna1-lifnr.
                gs_alv-clilfa1 = cli_lfa1.
                gs_alv-provlfa1 = pro_lfa1.
                gs_alv-campo_erroneo = 'BVTYP'.
                gs_alv-cli_valor = ls_cust_bankdetail-data-bvtyp.
                gs_alv-prov_valor = ls_vend_bankdetail-data-bvtyp.
                gs_alv-desc_camp_e = text-979.
                gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
                gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
                APPEND gs_alv TO gt_alv.
              ENDIF.
              IF ls_vend_bankdetail-data-xezer <> ls_cust_bankdetail-data-xezer.
                CLEAR gs_alv.
                gs_alv-kunnr = gs_kna1-kunnr.
                gs_alv-lifnr = gs_kna1-lifnr.
                gs_alv-clilfa1 = cli_lfa1.
                gs_alv-provlfa1 = pro_lfa1.
                gs_alv-campo_erroneo = 'XEZER'.
                gs_alv-cli_valor = ls_cust_bankdetail-data-xezer.
                gs_alv-prov_valor = ls_vend_bankdetail-data-xezer.
                gs_alv-desc_camp_e = text-980.
                gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
                gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
                APPEND gs_alv TO gt_alv.
              ENDIF.
              IF ls_vend_bankdetail-data-bkref <> ls_cust_bankdetail-data-bkref.
                CLEAR gs_alv.
                gs_alv-kunnr = gs_kna1-kunnr.
                gs_alv-lifnr = gs_kna1-lifnr.
                gs_alv-clilfa1 = cli_lfa1.
                gs_alv-provlfa1 = pro_lfa1.
                gs_alv-campo_erroneo = 'BKREF'.
                gs_alv-cli_valor = ls_cust_bankdetail-data-bkref.
                gs_alv-prov_valor = ls_vend_bankdetail-data-bkref.
                gs_alv-desc_camp_e = text-981.
                gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
                gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
                APPEND gs_alv TO gt_alv.
              ENDIF.
              IF ls_vend_bankdetail-data-koinh <> ls_cust_bankdetail-data-koinh.
                CLEAR gs_alv.
                gs_alv-kunnr = gs_kna1-kunnr.
                gs_alv-lifnr = gs_kna1-lifnr.
                gs_alv-clilfa1 = cli_lfa1.
                gs_alv-provlfa1 = pro_lfa1.
                gs_alv-campo_erroneo = 'KOINH'.
                gs_alv-cli_valor = ls_cust_bankdetail-data-koinh.
                gs_alv-prov_valor = ls_vend_bankdetail-data-koinh.
                gs_alv-desc_camp_e = text-982.
                gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
                gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
                APPEND gs_alv TO gt_alv.
              ENDIF.
              IF ls_vend_bankdetail-data-iban <> ls_cust_bankdetail-data-iban.
                CLEAR gs_alv.
                gs_alv-kunnr = gs_kna1-kunnr.
                gs_alv-lifnr = gs_kna1-lifnr.
                gs_alv-clilfa1 = cli_lfa1.
                gs_alv-provlfa1 = pro_lfa1.
                gs_alv-campo_erroneo = 'IBAN'.
                gs_alv-cli_valor = ls_cust_bankdetail-data-iban.
                gs_alv-prov_valor = ls_vend_bankdetail-data-iban.
                gs_alv-desc_camp_e = text-983.
                gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
                gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
                APPEND gs_alv TO gt_alv.
              ENDIF.
              IF ls_vend_bankdetail-data-iban_from_date <> ls_cust_bankdetail-data-iban_from_date.
                CLEAR gs_alv.
                gs_alv-kunnr = gs_kna1-kunnr.
                gs_alv-lifnr = gs_kna1-lifnr.
                gs_alv-clilfa1 = cli_lfa1.
                gs_alv-provlfa1 = pro_lfa1.
                gs_alv-campo_erroneo = 'IBAN_FROM_DATE'.
                gs_alv-cli_valor = ls_cust_bankdetail-data-iban_from_date.
                gs_alv-prov_valor = ls_vend_bankdetail-data-iban_from_date.
                gs_alv-desc_camp_e = text-984.
                gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
                gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
                APPEND gs_alv TO gt_alv.
              ENDIF.
            ELSE.
              "ADD JVM - Mostrar dígito de control
              IF ls_vend_bankdetail-data-bkont <> ls_cust_bankdetail-data-bkont.
                CLEAR gs_alv.
                gs_alv-kunnr = gs_kna1-kunnr.
                gs_alv-lifnr = gs_kna1-lifnr.
                gs_alv-clilfa1 = cli_lfa1.
                gs_alv-provlfa1 = pro_lfa1.
                gs_alv-campo_erroneo = 'BKONT'.
                gs_alv-cli_valor = ls_cust_bankdetail-data-bkont.
                gs_alv-prov_valor = ls_vend_bankdetail-data-bkont.
                gs_alv-desc_camp_e = text-978.
                gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
                gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
                APPEND gs_alv TO gt_alv.
              ENDIF.
              "FIN ADD JVM - Mostrar dígito de control

              IF ls_vend_bankdetail-data_key-banks <> ls_cust_bankdetail-data_key-banks.
                CLEAR gs_alv.
                gs_alv-kunnr = gs_kna1-kunnr.
                gs_alv-lifnr = gs_kna1-lifnr.
                gs_alv-clilfa1 = cli_lfa1.
                gs_alv-provlfa1 = pro_lfa1.
                gs_alv-campo_erroneo = 'BANKS'.
                gs_alv-cli_valor = ls_cust_bankdetail-data_key-banks.
                gs_alv-prov_valor = ls_vend_bankdetail-data_key-banks.
                gs_alv-desc_camp_e = text-985.
                gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
                gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
                APPEND gs_alv TO gt_alv.
              ENDIF.
              IF ls_vend_bankdetail-data_key-bankl <> ls_cust_bankdetail-data_key-bankl.
                CLEAR gs_alv.
                gs_alv-kunnr = gs_kna1-kunnr.
                gs_alv-lifnr = gs_kna1-lifnr.
                gs_alv-clilfa1 = cli_lfa1.
                gs_alv-provlfa1 = pro_lfa1.
                gs_alv-campo_erroneo = 'BANKL'.
                gs_alv-cli_valor = ls_cust_bankdetail-data_key-bankl.
                gs_alv-prov_valor = ls_vend_bankdetail-data_key-bankl.
                gs_alv-desc_camp_e = text-986.
                gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
                gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
                APPEND gs_alv TO gt_alv.
              ENDIF.
              IF ls_vend_bankdetail-data_key-bankn <> ls_cust_bankdetail-data_key-bankn.
                CLEAR gs_alv.
                gs_alv-kunnr = gs_kna1-kunnr.
                gs_alv-lifnr = gs_kna1-lifnr.
                gs_alv-clilfa1 = cli_lfa1.
                gs_alv-provlfa1 = pro_lfa1.
                gs_alv-campo_erroneo = 'BANKN'.
                gs_alv-cli_valor = ls_cust_bankdetail-data_key-bankn.
                gs_alv-prov_valor = ls_vend_bankdetail-data_key-bankn.
                gs_alv-desc_camp_e = text-987.
                gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
                gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
                APPEND gs_alv TO gt_alv.
              ENDIF.
            ENDIF.
          ENDLOOP.
          IF wa_subrc <> 0.
            CLEAR ls_vend_bankdetail.
            LOOP AT ls_customer_detail-central_data-bankdetail-bankdetails INTO ls_cust_bankdetail.
              IF ls_vend_bankdetail-data_key-banks <> ls_cust_bankdetail-data_key-banks.
                CLEAR gs_alv.
                gs_alv-kunnr = gs_kna1-kunnr.
                gs_alv-lifnr = gs_kna1-lifnr.
                gs_alv-clilfa1 = cli_lfa1.
                gs_alv-provlfa1 = pro_lfa1.
                gs_alv-campo_erroneo = 'BANKS'.
                gs_alv-cli_valor = ls_cust_bankdetail-data_key-banks.
                gs_alv-prov_valor = ls_vend_bankdetail-data_key-banks.
                gs_alv-desc_camp_e = text-985.
                gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
                gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
                APPEND gs_alv TO gt_alv.
              ENDIF.
              IF ls_vend_bankdetail-data_key-bankl <> ls_cust_bankdetail-data_key-bankl.
                CLEAR gs_alv.
                gs_alv-kunnr = gs_kna1-kunnr.
                gs_alv-lifnr = gs_kna1-lifnr.
                gs_alv-clilfa1 = cli_lfa1.
                gs_alv-provlfa1 = pro_lfa1.
                gs_alv-campo_erroneo = 'BANKL'.
                gs_alv-cli_valor = ls_cust_bankdetail-data_key-bankl.
                gs_alv-prov_valor = ls_vend_bankdetail-data_key-bankl.
                gs_alv-desc_camp_e = text-986.
                gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
                gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
                APPEND gs_alv TO gt_alv.
              ENDIF.
              IF ls_vend_bankdetail-data_key-bankn <> ls_cust_bankdetail-data_key-bankn.
                CLEAR gs_alv.
                gs_alv-kunnr = gs_kna1-kunnr.
                gs_alv-lifnr = gs_kna1-lifnr.
                gs_alv-clilfa1 = cli_lfa1.
                gs_alv-provlfa1 = pro_lfa1.
                gs_alv-campo_erroneo = 'BANKN'.
                gs_alv-cli_valor = ls_cust_bankdetail-data_key-bankn.
                gs_alv-prov_valor = ls_vend_bankdetail-data_key-bankn.
                gs_alv-desc_camp_e = text-987.
                gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
                gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
                APPEND gs_alv TO gt_alv.
              ENDIF.

              "ADD JVM - Mostrar dígito de control
              IF ls_vend_bankdetail-data-bkont <> ls_cust_bankdetail-data-bkont.
                CLEAR gs_alv.
                gs_alv-kunnr = gs_kna1-kunnr.
                gs_alv-lifnr = gs_kna1-lifnr.
                gs_alv-clilfa1 = cli_lfa1.
                gs_alv-provlfa1 = pro_lfa1.
                gs_alv-campo_erroneo = 'BKONT'.
                gs_alv-cli_valor = ls_cust_bankdetail-data-bkont.
                gs_alv-prov_valor = ls_vend_bankdetail-data-bkont.
                gs_alv-desc_camp_e = text-978.
                gs_alv-ktokd = ls_customer_detail-central_data-central-data-ktokd.
                gs_alv-ktokk = ls_vendors_detail-central_data-central-data-ktokk.
                APPEND gs_alv TO gt_alv.
              ENDIF.
              "FIN ADD JVM - Mostrar dígito de control

            ENDLOOP.
          ENDIF.

        ENDIF.
      ELSE.
        CLEAR gs_alv.
        gs_alv-kunnr = gs_kna1-kunnr.
        gs_alv-lifnr = gs_kna1-lifnr.
        gs_alv-clilfa1 = cli_lfa1.
        gs_alv-provlfa1 = pro_lfa1.
        APPEND gs_alv TO gt_alv.
      ENDIF.
    ENDLOOP.
  ENDIF.
ENDFORM.

*---------------------------------------------------------------------*
* Form CREATE_AND_DISPLAY_ALV
*---------------------------------------------------------------------*
FORM create_and_display_alv.

  PERFORM alv_layout.
  PERFORM alv_field_catalog.
  PERFORM alv_display.

ENDFORM.

*&---------------------------------------------------------------------*
*&      Form  ALV_LAYOUT
*&---------------------------------------------------------------------*
FORM alv_layout.

  gs_layout-zebra      = 'X'.
  gs_layout-sel_mode   = 'A'.

ENDFORM.

*---------------------------------------------------------------------*
*      Form  ALV_FIELD_CATALOG
*---------------------------------------------------------------------*
FORM alv_field_catalog.
  CLEAR: gt_fieldcat.

  CLEAR: gs_fieldcat.
  gs_fieldcat-fieldname = 'KUNNR'.
  gs_fieldcat-ref_table = 'KNA1'.
  APPEND gs_fieldcat TO gt_fieldcat.

  CLEAR: gs_fieldcat.
  gs_fieldcat-fieldname = 'PROVLFA1'.
  gs_fieldcat-ref_table = 'LFA1'.
  gs_fieldcat-scrtext_s = text-011.
  gs_fieldcat-coltext   = text-011.
  gs_fieldcat-seltext   = text-011.
  APPEND gs_fieldcat TO gt_fieldcat.

  CLEAR: gs_fieldcat.
  gs_fieldcat-fieldname = 'CLILFA1'.
  gs_fieldcat-ref_table = 'LFA1'.
  gs_fieldcat-scrtext_s = text-012.
  gs_fieldcat-coltext   = text-012.
  gs_fieldcat-seltext   = text-012.
  APPEND gs_fieldcat TO gt_fieldcat.

  CLEAR: gs_fieldcat.
  gs_fieldcat-fieldname = 'LIFNR'.
  gs_fieldcat-ref_table = 'KNA1'.
  gs_fieldcat-scrtext_s = text-013.
  gs_fieldcat-coltext   = text-013.
  gs_fieldcat-seltext   = text-013.
  APPEND gs_fieldcat TO gt_fieldcat.

  CLEAR: gs_fieldcat.
  gs_fieldcat-fieldname = 'CAMPO_ERRONEO'.
  gs_fieldcat-scrtext_s = text-003.
  gs_fieldcat-coltext   = text-003.
  gs_fieldcat-seltext   = text-003.
  APPEND gs_fieldcat TO gt_fieldcat.

  CLEAR: gs_fieldcat.
  gs_fieldcat-fieldname = 'CLI_VALOR'.
  gs_fieldcat-scrtext_s = text-004.
  gs_fieldcat-coltext   = text-004.
  gs_fieldcat-seltext   = text-004.
  gs_fieldcat-outputlen = 25.
  APPEND gs_fieldcat TO gt_fieldcat.

  CLEAR: gs_fieldcat.
  gs_fieldcat-fieldname = 'PROV_VALOR'.
  gs_fieldcat-scrtext_s = text-006.
  gs_fieldcat-coltext   = text-006.
  gs_fieldcat-seltext   = text-006.
  gs_fieldcat-outputlen = 25.
  APPEND gs_fieldcat TO gt_fieldcat.

  CLEAR: gs_fieldcat.
  gs_fieldcat-fieldname = 'DESC_CAMP_E'.
  gs_fieldcat-scrtext_s = text-008.
  gs_fieldcat-coltext   = text-008.
  gs_fieldcat-seltext   = text-008.
  gs_fieldcat-outputlen = 35.
  APPEND gs_fieldcat TO gt_fieldcat.

  CLEAR: gs_fieldcat.
  gs_fieldcat-fieldname = 'KTOKD'.
  gs_fieldcat-ref_table = 'KNA1'.
  gs_fieldcat-scrtext_s = text-009.
  gs_fieldcat-coltext   = text-009.
  gs_fieldcat-seltext   = text-009.
  APPEND gs_fieldcat TO gt_fieldcat.

  CLEAR: gs_fieldcat.
  gs_fieldcat-fieldname = 'KTOKK'.
  gs_fieldcat-ref_table = 'LFA1'.
  gs_fieldcat-scrtext_s = text-010.
  gs_fieldcat-coltext   = text-010.
  gs_fieldcat-seltext   = text-010.
  APPEND gs_fieldcat TO gt_fieldcat.
ENDFORM.

*&---------------------------------------------------------------------*
*&      Form  ALV_DISPLAY
*&---------------------------------------------------------------------*
FORM alv_display.

  g_repid = sy-cprog.
  CALL FUNCTION 'REUSE_ALV_GRID_DISPLAY_LVC' ##FM_SUBRC_OK
    EXPORTING
      i_callback_program      = g_repid
      i_callback_user_command = 'USER_COMMAND'
      is_layout_lvc           = gs_layout
      i_default               = 'X'
      i_save                  = 'A'
      it_fieldcat_lvc         = gt_fieldcat
      is_variant              = g_variant
    TABLES
      t_outtab                = gt_alv[]
    EXCEPTIONS
      program_error           = 1
      OTHERS                  = 2.

ENDFORM.

*---------------------------------------------------------------------*
*      Form  STATUS_SET
*---------------------------------------------------------------------*
FORM status_set USING rt_extab TYPE slis_t_extab.
  ##STAT_UNDEF  SET PF-STATUS 'STANDARD_FULLSCREEN'.
ENDFORM.

*---------------------------------------------------------------------*
*      Form  user_command
*---------------------------------------------------------------------*
FORM user_command USING l_ucomm     TYPE sy-ucomm
                        l_selfield  TYPE slis_selfield.

  CASE l_ucomm.
    WHEN '&IC1'.
      READ TABLE gt_alv INTO gs_alv INDEX l_selfield-tabindex.
      IF sy-subrc EQ 0.
        CASE l_selfield-fieldname.
          WHEN 'KUNNR'.
            IF gs_alv-kunnr IS NOT INITIAL.
              SET PARAMETER ID 'KUN' FIELD gs_alv-kunnr.
              CALL TRANSACTION 'XD03' AND SKIP FIRST SCREEN. "#EC CI_CALLTA
            ENDIF.

          WHEN 'PROVLFA1'.
            IF gs_alv-provlfa1 IS NOT INITIAL.
              SET PARAMETER ID 'LIF' FIELD gs_alv-lifnr.
              CALL TRANSACTION 'XK03' AND SKIP FIRST SCREEN. "#EC CI_CALLTA
            ENDIF.

          WHEN 'LIFNR'.
            IF gs_alv-lifnr IS NOT INITIAL.
              SET PARAMETER ID 'LIF' FIELD gs_alv-lifnr.
              CALL TRANSACTION 'XK03' AND SKIP FIRST SCREEN. "#EC CI_CALLTA
            ENDIF.
        ENDCASE.
      ENDIF.
  ENDCASE.

ENDFORM.


*---------------------------------------------------------------------*
*      Form  VARIANT_INIT
*---------------------------------------------------------------------*
FORM variant_init.

  CLEAR gx_variant.

  g_repid           = sy-repid.
  g_save            = 'A'.
  gx_variant-report = g_repid.

  CALL FUNCTION 'LVC_VARIANT_DEFAULT_GET'
    EXPORTING
      i_save        = g_save
    CHANGING
      cs_variant    = gx_variant
    EXCEPTIONS
      wrong_input   = 1
      not_found     = 2
      program_error = 3
      OTHERS        = 4.
  IF sy-subrc = 0.
    p_vari = gx_variant-variant.
  ENDIF.

ENDFORM.

*---------------------------------------------------------------------*
*      Form  PAI_OF_SELECTION_SCREEN
*---------------------------------------------------------------------*
FORM pai_of_selection_screen.

  IF NOT p_vari IS INITIAL.

    gx_variant-report  = sy-repid.
    gx_variant-variant = p_vari.

    CALL FUNCTION 'LVC_VARIANT_EXISTENCE_CHECK'
      EXPORTING
        i_save     = g_save
      CHANGING
        cs_variant = gx_variant.

    g_variant = gx_variant.

  ELSE.

    PERFORM variant_init.

  ENDIF.

ENDFORM.

*---------------------------------------------------------------------*
*      Form  F4_FOR_VARIANT
*---------------------------------------------------------------------*
FORM f4_for_variant.

  g_variant-report = sy-repid.
  CALL FUNCTION 'LVC_VARIANT_F4'
    EXPORTING
      is_variant    = g_variant
      i_save        = g_save
    IMPORTING
      e_exit        = g_exit
      es_variant    = gx_variant
    EXCEPTIONS
      not_found     = 1
      program_error = 2
      OTHERS        = 3.
  IF sy-subrc <> 0.
    MESSAGE ID sy-msgid TYPE 'S' NUMBER sy-msgno WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
  ELSE.
    IF g_exit = space.
      p_vari = gx_variant-variant.
    ENDIF.
  ENDIF.

ENDFORM.
