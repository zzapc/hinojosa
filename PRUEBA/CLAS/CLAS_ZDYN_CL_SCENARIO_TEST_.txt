
* To use those macros in a class put this line:
* INCLUDE zdyn_cl_scenario_test=========ccmac.
* in the Local definitions/Implementations section of the class

*************************************************************************
* Macros for mock methods

DEFINE check_method.

* we assume that this macros is always called,
* hence the field symbol is defined
  DATA: ls          TYPE string,
        li_len      TYPE i.
  FIELD-SYMBOLS: <st_exp_value> TYPE LINE OF zdyn_stru_scenario-scenario,
                 <st_msg>       TYPE bapiret2,
                 <t_output>     TYPE any,
                 <t_input>      TYPE any.                   "#EC NEEDED
* Verify if we are in the expected place in the process
  READ TABLE &1-scenario ASSIGNING <st_exp_value>
    WITH KEY id     = &1-current_id
             method = &2
             param  = ''.
  CHECK sy-subrc = 0.
  <st_exp_value>-ok = abap_true.

END-OF-DEFINITION.

DEFINE check_input.

  READ TABLE &1-scenario ASSIGNING <st_exp_value>
    WITH KEY id    = &1-current_id
             param = &2.
  IF sy-subrc = 0.
    ls = &3.

    zdyn_cl_scenario_test=>remove_special_chars( CHANGING cs = ls ).
    zdyn_cl_scenario_test=>remove_special_chars( CHANGING cs = <st_exp_value>-value ).

    CHECK <st_exp_value>-value = ls.
    <st_exp_value>-ok = abap_true.
  ENDIF.

END-OF-DEFINITION.

DEFINE check_input_tab_len.

  READ TABLE &1-scenario ASSIGNING <st_exp_value>
    WITH KEY id    = &1-current_id
             param = &2.
  IF sy-subrc = 0.
    li_len = lines( &3 ).

    CHECK <st_exp_value>-value = li_len.
    <st_exp_value>-ok = abap_true.
  ENDIF.

END-OF-DEFINITION.

DEFINE check_input_ref.

  READ TABLE &1-scenario ASSIGNING <st_exp_value>
    WITH KEY id    = &1-current_id
             param = &2.
  IF sy-subrc = 0.
    ASSIGN <st_exp_value>-val_ref->* to <t_input>.
    CHECK <t_input> = &3.
    <st_exp_value>-ok = abap_true.
  ENDIF.

END-OF-DEFINITION.

DEFINE set_output.

  READ TABLE &1-scenario ASSIGNING <st_exp_value>
    WITH KEY id    = &1-current_id
             param = &2.
  IF sy-subrc = 0.
    &3 = <st_exp_value>-value.
    <st_exp_value>-ok = abap_true.
  ENDIF.

END-OF-DEFINITION.

DEFINE set_output_ref.

  READ TABLE &1-scenario ASSIGNING <st_exp_value>
    WITH KEY id    = &1-current_id
             param = &2.
  IF sy-subrc = 0.
    ASSIGN <st_exp_value>-val_ref->* to <t_output>.
    &3 = <t_output>.
    <st_exp_value>-ok = abap_true.
  ENDIF.

END-OF-DEFINITION.

DEFINE add_msg.

  READ TABLE &1-scenario ASSIGNING <st_exp_value>
    WITH KEY id    = &1-current_id
             param = &2.
  IF sy-subrc = 0.
*    loop at <st_exp_value>-value ASSIGNING <st_msg>.
      zdyn_cl_msg=>add_msgs( <st_exp_value>-value ).
*    ENDLOOP.
  ENDIF.

END-OF-DEFINITION.

DEFINE next_method.

  &1-current_id = &1-current_id + 1.

END-OF-DEFINITION.

DEFINE add_method.

  lst_exp_value-id      = &2.
  lst_exp_value-method  = &3.
  lst_exp_value-param   = &4.
  lst_exp_value-value   = &5.
  APPEND lst_exp_value TO &1.

END-OF-DEFINITION.


*************************************************************************
* Macros for scenario definitions
* They require local variable definitions in the code where they are used

DEFINE add_method.

  IF &2 <> 0.
    mi_id = &2.
  ELSE.
    mi_id = lst_val-id.
  ENDIF.

  CLEAR lst_val.
  lst_val-id      = mi_id.
  lst_val-method  = &3.
  lst_val-param   = &4.
  lst_val-value   = &5.
  APPEND lst_val TO &1.

END-OF-DEFINITION.

DEFINE add_method_ref.

  IF &2 <> 0.
    mi_id = &2.
  ELSE.
    mi_id = lst_val-id.
  ENDIF.

  CLEAR lst_val.
  lst_val-id      = mi_id.
  lst_val-method  = &3.
  lst_val-param   = &4.
  lst_val-val_ref = &5.
  APPEND lst_val TO &1.

END-OF-DEFINITION.

DEFINE add_extdata.
  lst_extdata-node          = &1.
  lst_extdata-subnode       = &2.
  lst_extdata-parentnode    = &3.
  lst_extdata-parentsubnode = &4.
  lst_extdata-extfield      = &5.
  lst_extdata-extent        = &6.
  lst_extdata-extvalue      = &7.
  APPEND lst_extdata TO <t_extdata>.
END-OF-DEFINITION.

*************************************************************************
* Macros used in unit test classes.
* They require local variable definition for the ZDYN_CL_WS_UT object

DEFINE assert_msg.
  CHECK 1 = mo_ut->assert_len( tab = &1
                               len = &2 ).
  READ TABLE &1 TRANSPORTING NO FIELDS
    WITH KEY type = &3
             id   = &4
             number = &5
             message_v1 = &6
             message_v2 = &7
             message_v3 = &8.
  CHECK 1 = mo_ut->assert_read( ).
END-OF-DEFINITION.
class ZDYN_CL_SCENARIO_TEST definition
  public
  create public .

public section.

  data MB_XML_COMPRESSED type ABAP_BOOL read-only .
  class-data MST_SCENARIO type ZDYN_STRU_SCENARIO read-only .
  class-data MI_ID type INT1 .

  class-methods REMOVE_SPECIAL_CHAR
    importing
      !IX_CHAR type XSTRING default '0A'
    changing
      !CS type STRING .
  class-methods REMOVE_SPECIAL_CHARS
    changing
      !CS type STRING .
  class-methods EVALUATE .
  methods SET_XML_COMPRESSED
    importing
      !IB_COMPRESSED type ABAP_BOOL .
protected section.

  methods CREATE_GET_CUSTOMERS
    importing
      !II_NUM_OF_CUSTOMERS type I default 1
      !II_NUM_OF_COMP_CODES type I default 1
    exporting
      !ER_SEL_OPT type ref to DATA
      !ER_CUSTOMERS type ref to DATA .
  methods CREATE_GET_VENDORS
    importing
      !II_NUM_OF_VENDORS type I default 1
      !II_NUM_OF_COMP_CODES type I default 1
    exporting
      !ER_SEL_OPT type ref to DATA
      !ER_VENDORS type ref to DATA .
  methods CREATE_GET_CUSTOMER_BANKS_01
    exporting
      !ER_BANKS type ref to DATA .
  methods CREATE_GET_CUSTOMER_BANKS_02
    exporting
      !ER_BANKS type ref to DATA .
  methods CREATE_GET_VENDOR_BANKS_01
    exporting
      !ER_BANKS type ref to DATA .
  methods CREATE_GET_VENDOR_BANKS_02
    exporting
      !ER_BANKS type ref to DATA .
  methods CREATE_ARCHIVE_CREATE_LINK_01
    importing
      !IS_FILENAME type STRING optional
    exporting
      !ER_ARC type ref to DATA .
  methods CREATE_ARCHIVE_CREATE_LINK_02
    exporting
      !ER_ARC type ref to DATA .
  methods CREATE_GET_WBS_ELEMENTS
    importing
      !II_NUM_OF_COMP_CODES type I default 1
    exporting
      !ER_SEL_OPT type ref to DATA
      !ER_WBS_ELEMENTS type ref to DATA .
  methods CREATE_GET_TAX_CODES
    importing
      !II_NUM_OF_COMP_CODES type I default 1
    exporting
      !ER_SEL_OPT type ref to DATA
      !ER_TAX_CODES type ref to DATA .
  methods CREATE_LANGU
    exporting
      !ER_SEL_LANGU type ref to DATA .
  methods CREATE_GET_PAYMENT_TERMS
    exporting
      !ER_SEL_OPT type ref to DATA
      !ER_TERMS type ref to DATA .
  methods CREATE_GET_ORDERS
    importing
      !II_NUM_OF_COMP_CODES type I default 1
    exporting
      !ER_SEL_OPT type ref to DATA
      !ER_ORDERS type ref to DATA .
  methods CREATE_GET_IDOC_CONTROL_RECORD
    exporting
      !ER_RECORD type ref to DATA .
  methods CREATE_GET_COST_CENTERS_01
    exporting
      !ER_SEL_OPT type ref to DATA
      !ER_COST_CENTERS type ref to DATA .
  methods CREATE_GET_COST_CENTERS_02
    exporting
      !ER_SEL_OPT type ref to DATA
      !ER_COST_CENTERS type ref to DATA .
  methods CREATE_GET_COMPANY_CODES_02
    exporting
      !ER_SEL_OPT type ref to DATA
      !ER_COMPANY_CODES type ref to DATA .
  methods CREATE_GET_COMPANY_CODES
    exporting
      !ER_SEL_OPT type ref to DATA
      !ER_COMPANY_CODES type ref to DATA .
  methods CREATE_COMPANY_CODES_02
    exporting
      !ER_SEL_OPT type ref to DATA .
  methods CREATE_COMPANY_CODES_01
    exporting
      !ER_SEL_OPT type ref to DATA .
  methods CREATE_FI_PRINT_ZTERM
    exporting
      !ER_TEXTS type ref to DATA .
  methods CREATE_ARCHIVE_PREPARE_01
    importing
      !IS_FILENAME type STRING optional
    exporting
      !ER_ARC_1 type ref to DATA
      !ER_ARC_2 type ref to DATA .
  methods CREATE_ARCHIVE_PREPARE_02
    exporting
      !ER_ARC_1 type ref to DATA
      !ER_ARC_2 type ref to DATA .
  methods CREATE_ARCHIVE_EXTERNAL_DATA_1
    exporting
      !ER_ARC_CONTENT type ref to DATA .
  methods CREATE_ARCHIVE_EXTERNAL_DATA_2
    exporting
      !ER_ARC_CONTENT type ref to DATA .
  methods CREATE_GET_CURRENCY_TEXTS
    exporting
      !ER_SEL_OPT type ref to DATA
      !ER_CURRENCY_TEXTS type ref to DATA .
  methods CREATE_GET_GL_ACCOUNTS
    importing
      !II_NUM_OF_COMP_CODES type I default 1
    exporting
      !ER_SEL_OPT type ref to DATA
      !ER_GL_ACCOUNTS type ref to DATA .
  methods CREATE_GET_GL_ACC_DETAILS_01
    exporting
      !ER_DETAILS type ref to DATA .
  methods CREATE_GET_GL_ACC_DETAILS_02
    exporting
      !ER_DETAILS type ref to DATA .
  methods CREATE_BAPI_CC_GETDETAIL_DATA
    importing
      !IC_COMP_CODE type BUKRS optional
    exporting
      !ER_COMPANYCODE_DETAIL type ref to DATA
      !ER_COMPANYCODE_ADDRESS type ref to DATA
      !ER_RETURN type ref to DATA .
  methods CREATE_BAPI_PO_GETDETAIL_DATA
    exporting
      !ER_PO_HEADER type ref to DATA
      !ER_PO_ITEMS type ref to DATA
      !ER_PO_ITEM_HISTORY type ref to DATA
      !ER_PO_ITEM_HISTORY_TOTALS type ref to DATA .
  methods CREATE_RFC_DATA_SUBMIT_DATA_MM
    importing
      !IB_WITH_CUSTOM type ABAP_BOOL default ABAP_FALSE
      !IB_SKIP_ATTACH type ABAP_BOOL default ABAP_FALSE
      !IB_EXPRESS type ABAP_BOOL default ABAP_FALSE
      !IB_WITH_PDAP type ABAP_BOOL default ABAP_FALSE
      !IB_WITH_EMAIL type ABAP_BOOL default ABAP_FALSE
    exporting
      !ER_RFC_EXTDATA type ref to DATA
      !ER_RFC_ARCHIVING type ref to DATA
      !ER_RFC_CONTENT type ref to DATA
      !ER_RFC_BO_HDR type ref to DATA
      !ER_RFC_STATUS type ref to DATA
      !ER_RFC_MESSAGES type ref to DATA .
  methods CREATE_RFC_DATA_SUBMIT_DATA_FI
    exporting
      !ER_RFC_EXTDATA type ref to DATA
      !ER_RFC_ARCHIVING type ref to DATA
      !ER_RFC_CONTENT type ref to DATA
      !ER_RFC_BO_HDR type ref to DATA
      !ER_RFC_STATUS type ref to DATA
      !ER_RFC_MESSAGES type ref to DATA .
private section.
endclass. "ZDYN_CL_SCENARIO_TEST definition
class ZDYN_CL_SCENARIO_TEST implementation.
METHOD CREATE_ARCHIVE_CREATE_LINK_01.

**************************************************************************************************
* Required for scenario where Invoice is sent from Routty as IDOC to SAP

**************************************************************************************************

  FIELD-SYMBOLS: <st_arc>   TYPE zdyn_stru_archive.

**************************************************************************************************
**************************************************************************************************
* Data for the BAPI in SAP
  CREATE DATA er_arc LIKE <st_arc>.
  ASSIGN er_arc->* TO <st_arc>.

  <st_arc>-sap_object	    = 'IDOC'.
  <st_arc>-ar_object      = 'ZEIC_PDFIV'.
  <st_arc>-archiv_id      = 'D1'.
  <st_arc>-document_type  = 'PDF'.
  <st_arc>-mimetype       = 'application/pdf'.
  <st_arc>-binlength      = '000000000028'.
  <st_arc>-object_id      = '0000000003230747'.
  <st_arc>-arc_doc_id	    = '000C29FDBA9E1EDCAAD25447B5B8A0E2'.
  IF is_filename IS NOT INITIAL.
    <st_arc>-filename	= is_filename.
  ELSE.
    <st_arc>-filename	= '41babc06-9205-4ea7-ae84-3faf8860c70e_generated.pdf'.
  ENDIF.

ENDMETHOD.
METHOD CREATE_ARCHIVE_CREATE_LINK_02.

**************************************************************************************************
* Required for scenario where Invoice is sent from Routty as IDOC to SAP

**************************************************************************************************

  FIELD-SYMBOLS: <st_arc>   TYPE zdyn_stru_archive.

**************************************************************************************************
**************************************************************************************************
* Data for the BAPI in SAP
  CREATE DATA er_arc LIKE <st_arc>.
  ASSIGN er_arc->* TO <st_arc>.

  <st_arc>-sap_object	    = 'IDOC'.
  <st_arc>-ar_object      = 'ZEIC_PDFIV'.
  <st_arc>-archiv_id      = 'D1'.
  <st_arc>-document_type  = 'PDF'.
  <st_arc>-mimetype       = 'application/pdf'.
  <st_arc>-binlength      = '000000000023'.
  <st_arc>-object_id      = '0000000003230747'.
  <st_arc>-arc_doc_id	    = '000C29FDBA9E1EDCAAD25447B5B8A0E3'.
  <st_arc>-filename	      = 'Base_41babc06-9205-4ea7-ae84-3faf8860c70e.pdf'.

ENDMETHOD.
METHOD CREATE_ARCHIVE_EXTERNAL_DATA_1.

**************************************************************************************************
* Required for scenario where Invoice is sent from Routty as IDOC to SAP

**************************************************************************************************

  FIELD-SYMBOLS: <t_content>   TYPE rmps_t_1024.
  DATA: lst_content   LIKE LINE OF <t_content>.

**************************************************************************************************
**************************************************************************************************
* Data for the BAPI in SAP
  CREATE DATA er_arc_content LIKE <t_content>.
  ASSIGN er_arc_content->* TO <t_content>.

  lst_content-line = '546869732069732067656E657261746564206174746163686D656E74'.
  APPEND lst_content TO <t_content>.


ENDMETHOD.
METHOD CREATE_ARCHIVE_EXTERNAL_DATA_2.

**************************************************************************************************
* Required for scenario where Invoice is sent from Routty as IDOC to SAP

**************************************************************************************************

  FIELD-SYMBOLS: <t_content>   TYPE rmps_t_1024.
  DATA: lst_content   LIKE LINE OF <t_content>.

**************************************************************************************************
**************************************************************************************************
* Data for the BAPI in SAP
  CREATE DATA er_arc_content LIKE <t_content>.
  ASSIGN er_arc_content->* TO <t_content>.

  lst_content-line = '546869732069732042617365206174746163686D656E74'.
  APPEND lst_content TO <t_content>.


ENDMETHOD.
METHOD create_archive_prepare_01.

**************************************************************************************************
* Required for scenario where Invoice is sent from Routty as IDOC to SAP

**************************************************************************************************

  FIELD-SYMBOLS: <st_arc>   TYPE zdyn_stru_archive.

**************************************************************************************************
**************************************************************************************************
* Data for the BAPI in SAP
  CREATE DATA er_arc_1 LIKE <st_arc>.

  ASSIGN er_arc_1->* TO <st_arc>.

* Input value
  <st_arc>-sap_object	    = 'IDOC'.
  <st_arc>-ar_object      = 'ZEIC_PDFIV'.
  <st_arc>-archiv_id      = ''.
  <st_arc>-document_type  = ''.
  <st_arc>-mimetype       = 'application/pdf'.
  <st_arc>-binlength      = '000000000028'.
  <st_arc>-object_id      = '0000000003230747'.
  IF is_filename IS NOT INITIAL.
    <st_arc>-filename	= is_filename.
  ELSE.
    <st_arc>-filename	= '41babc06-9205-4ea7-ae84-3faf8860c70e_generated.pdf'.
  ENDIF.

* Value modified in the method
  CREATE DATA er_arc_2 LIKE <st_arc>.
  ASSIGN er_arc_2->* TO <st_arc>.

  <st_arc>-sap_object	    = 'IDOC'.
  <st_arc>-ar_object      = 'ZEIC_PDFIV'.
  <st_arc>-archiv_id      = 'D1'.
  <st_arc>-document_type  = 'PDF'.
  <st_arc>-mimetype       = 'application/pdf'.
  <st_arc>-binlength      = '000000000028'.
  <st_arc>-object_id      = '0000000003230747'.
  IF is_filename IS NOT INITIAL.
    <st_arc>-filename	= is_filename.
  ELSE.
    <st_arc>-filename	= '41babc06-9205-4ea7-ae84-3faf8860c70e_generated.pdf'.
  ENDIF.

ENDMETHOD.
METHOD CREATE_ARCHIVE_PREPARE_02.

**************************************************************************************************
* Required for scenario where Invoice is sent from Routty as IDOC to SAP

**************************************************************************************************

  FIELD-SYMBOLS: <st_arc>   TYPE zdyn_stru_archive.

**************************************************************************************************
**************************************************************************************************
* Data for the BAPI in SAP

* Input value
  CREATE DATA er_arc_1 LIKE <st_arc>.
  ASSIGN er_arc_1->* TO <st_arc>.

  <st_arc>-sap_object	    = 'IDOC'.
  <st_arc>-ar_object      = 'ZEIC_PDFIV'.
  <st_arc>-archiv_id      = ''.
  <st_arc>-document_type  = ''.
  <st_arc>-mimetype       = 'application/pdf'.
  <st_arc>-binlength      = '000000000023'.
  <st_arc>-object_id      = '0000000003230747'.
  <st_arc>-filename	      = 'Base_41babc06-9205-4ea7-ae84-3faf8860c70e.pdf'.

* Value modified in the method
  CREATE DATA er_arc_2 LIKE <st_arc>.
  ASSIGN er_arc_2->* TO <st_arc>.

  <st_arc>-sap_object	    = 'IDOC'.
  <st_arc>-ar_object      = 'ZEIC_PDFIV'.
  <st_arc>-archiv_id      = 'D1'.
  <st_arc>-document_type  = 'PDF'.
  <st_arc>-mimetype       = 'application/pdf'.
  <st_arc>-binlength      = '000000000023'.
  <st_arc>-object_id      = '0000000003230747'.
  <st_arc>-filename	      = 'Base_41babc06-9205-4ea7-ae84-3faf8860c70e.pdf'.

ENDMETHOD.
METHOD create_bapi_cc_getdetail_data.

**************************************************************************************************
* Required for scenario where Company Code is sent from SAP to Routty

**************************************************************************************************

  FIELD-SYMBOLS: <st_companycode_detail>  TYPE bapi0002_2,
                 <st_companycode_address> TYPE bapi0002_3,
                 <st_return>              TYPE bapireturn.

**************************************************************************************************
**************************************************************************************************
* Data for the BAPI in SAP

* Company Code Details
  CREATE DATA er_companycode_detail LIKE <st_companycode_detail>.
  ASSIGN er_companycode_detail->* TO <st_companycode_detail>.

* Company Code Address
  CREATE DATA er_companycode_address LIKE <st_companycode_address>.
  ASSIGN er_companycode_address->* TO <st_companycode_address>.

  IF ic_comp_code IS INITIAL OR ic_comp_code = '1043'.

    <st_companycode_detail>-comp_code	    = '1043'.
    <st_companycode_detail>-comp_name	    = 'Dynatos Österreich'.
    <st_companycode_detail>-city          = 'Wien'.
    <st_companycode_detail>-country	      = 'AT'.
    <st_companycode_detail>-currency      = 'EUR'.
    <st_companycode_detail>-langu	        = 'D'.
    <st_companycode_detail>-chrt_accts    = 'INT'.
    <st_companycode_detail>-fy_variant    = 'K4'.
    <st_companycode_detail>-vat_reg_no    = 'ABC123'.
    <st_companycode_detail>-addr_no	      = '0000730185'.
    <st_companycode_detail>-country_iso	  = 'AT'.
    <st_companycode_detail>-currency_iso  = 'EUR'.
    <st_companycode_detail>-langu_iso	    = 'DE'.

    <st_companycode_address>-addr_no    = '0000730185'.
    <st_companycode_address>-formofaddr = 'Firma'.
    <st_companycode_address>-name	      = 'Dynatos Österreich GmbH'.
    <st_companycode_address>-city	      = 'Wien'.
    <st_companycode_address>-postl_cod1	= '1120'.
    <st_companycode_address>-street	    = 'Heugasse'.
    <st_companycode_address>-house_no	  = '1'.
    <st_companycode_address>-country    = 'AT'.
    <st_companycode_address>-langu      = 'D'.
    <st_companycode_address>-region	    = 'W'.
    <st_companycode_address>-sort1      = 'DYNATOS'.
    <st_companycode_address>-time_zone  = 'CET'.

  ELSEIF ic_comp_code = '1049'.

    <st_companycode_detail>-comp_code	    = '1049'.
    <st_companycode_detail>-comp_name	    = 'Dynatos Deutschland GmbH'.
    <st_companycode_detail>-city          = 'Frankfurt'.
    <st_companycode_detail>-country	      = 'DE'.
    <st_companycode_detail>-currency      = 'EUR'.
    <st_companycode_detail>-langu	        = 'D'.
    <st_companycode_detail>-chrt_accts    = 'INT'.
    <st_companycode_detail>-fy_variant    = 'K4'.
    <st_companycode_detail>-vat_reg_no    = 'DE345740205'.
    <st_companycode_detail>-addr_no	      = '0000730175'.
    <st_companycode_detail>-country_iso	  = 'DE'.
    <st_companycode_detail>-currency_iso  = 'EUR'.
    <st_companycode_detail>-langu_iso	    = 'DE'.

    <st_companycode_address>-addr_no    = '0000730175'.
    <st_companycode_address>-formofaddr = 'Firma'.
    <st_companycode_address>-name	      = 'Dynatos Deutschland GmbH'.
    <st_companycode_address>-city	      = 'Frankfurt'.
    <st_companycode_address>-postl_cod1	= '60311'.
    <st_companycode_address>-street	    = 'Zeil'.
    <st_companycode_address>-house_no	  = '1'.
    <st_companycode_address>-country    = 'DE'.
    <st_companycode_address>-langu      = 'D'.
    <st_companycode_address>-region	    = '06'.
    <st_companycode_address>-sort1      = 'DYNATOS'.
    <st_companycode_address>-time_zone  = 'CET'.

  ENDIF.

* Messages
  CREATE DATA er_return LIKE <st_return>.
  ASSIGN er_return->* TO <st_return>.
* no messages for now

ENDMETHOD.
METHOD create_bapi_po_getdetail_data.

**************************************************************************************************
* Required for scenario where Purchase Order is sent from SAP to Routty

**************************************************************************************************

  FIELD-SYMBOLS: <st_po_header>             TYPE bapiekkol,
                 <t_po_items>               TYPE zdyn_lstru_bapiekpo,
                 <t_po_item_history>        TYPE zdyn_lstru_bapiekbe,
                 <t_po_item_history_totals> TYPE zdyn_lstru_bapiekbes.
  DATA: lst_po_item                LIKE LINE OF <t_po_items>,
        lst_po_item_history        LIKE LINE OF <t_po_item_history>,
        lst_po_item_history_totals LIKE LINE OF <t_po_item_history_totals>.

**************************************************************************************************
**************************************************************************************************
* Data for the BAPI in SAP

* PO Header
  CREATE DATA er_po_header LIKE <st_po_header>.
  ASSIGN er_po_header->* TO <st_po_header>.

  <st_po_header>-po_number    = '4500022685'.
  <st_po_header>-co_code      = '1043'.
  <st_po_header>-doc_cat      = 'F'.
  <st_po_header>-doc_type	    = 'NB'.
  <st_po_header>-status	      = '9'.
  <st_po_header>-created_on	  = '20220225'.
  <st_po_header>-created_by	  = 'USER'.
  <st_po_header>-item_intvl	  = '00010'.
  <st_po_header>-last_item    = '00010'.
  <st_po_header>-vendor	      = '0000043001'.
  <st_po_header>-language	    = 'E'.
  <st_po_header>-pmnttrms	    = '0001'.
  <st_po_header>-purch_org    = '1043'.
  <st_po_header>-pur_group    = '000'.
  <st_po_header>-currency	    = 'EUR'.
  <st_po_header>-exch_rate    = '1.00000'.
  <st_po_header>-doc_date	    = '20220225'.
  <st_po_header>-incoterms1	  = 'EXW'.
  <st_po_header>-incoterms2   = 'Wien'.
  <st_po_header>-target_val	  = '0.0000'.
  <st_po_header>-doc_cond	    = '1000039239'.
  <st_po_header>-procedure    = 'RM0000'.
  <st_po_header>-update_grp	  = 'SAP'.
  <st_po_header>-subitemint	  = '00001'.
  <st_po_header>-taxr_cntry	  = 'AT'.
  <st_po_header>-vend_name    = 'OMV AG'.
  <st_po_header>-currency_iso	= 'EUR'.


* PO Items
  CREATE DATA er_po_items LIKE <t_po_items>.
  ASSIGN er_po_items->* TO <t_po_items>.

  lst_po_item-po_number       = '4500022685'.
  lst_po_item-po_item	        = '00010'.
  lst_po_item-changed_on      = '20220225'.
  lst_po_item-short_text      = 'Casings'.
  lst_po_item-material        = '100-100'.
  lst_po_item-pur_mat	        = '100-100'.
  lst_po_item-co_code	        = '1043'.
  lst_po_item-plant	          = '1043'.
  lst_po_item-mat_grp	        = '001'.
  lst_po_item-info_rec        = '5300010896'.
  lst_po_item-target_qty      = '0.000'.
  lst_po_item-quantity        = '100.000'.
  lst_po_item-unit            = 'ST'.
  lst_po_item-orderpr_un      = 'ST'.
  lst_po_item-conv_num1	      = '1'.
  lst_po_item-conv_den1	      = '1'.
  lst_po_item-conv_num2	      = '1'.
  lst_po_item-conv_den2	      = '1'.
  lst_po_item-net_price	      = '80.0000'.
  lst_po_item-price_unit      = '1'.
  lst_po_item-net_value	      = '8000.0000'.
  lst_po_item-gros_value      = '8000.0000'.
  lst_po_item-info_upd        = 'C'.
  lst_po_item-prnt_price      = 'X'.
  lst_po_item-reminder1	      = '10'.
  lst_po_item-reminder2	      = '20'.
  lst_po_item-reminder3	      = '30'.
  lst_po_item-del_compl	      = 'X'.
  lst_po_item-acctasscat      = 'K'.
  lst_po_item-consumpt        = 'V'.
  lst_po_item-gr_ind          = 'X'.
  lst_po_item-ir_ind          = 'X'.
  lst_po_item-base_unit	      = 'ST'.
  lst_po_item-price_date      = '20220225'.
  lst_po_item-doc_cat	        = 'F'.
  lst_po_item-eff_value	      = '8000.0000'.
  lst_po_item-commitment      = 'X'.
  lst_po_item-update_grp      = 'SAP'.
  lst_po_item-net_weight      = '3.000'.
  lst_po_item-weightunit      = 'KG'.
  lst_po_item-gross_wght      = '3.000'.
  lst_po_item-ser_no          = '0001'.
  lst_po_item-mat_type        = 'HALB'.
  lst_po_item-po_unit_iso	    = 'PCE'.
  lst_po_item-orderpr_un_iso  = 'PCE'.
  lst_po_item-base_uom_iso    = 'PCE'.
  lst_po_item-weightunit_iso  = 'KGM'.

  APPEND lst_po_item TO <t_po_items>.


* PO Item history
  CREATE DATA er_po_item_history LIKE <t_po_item_history>.
  ASSIGN er_po_item_history->* TO <t_po_item_history>.

  lst_po_item_history-po_item	     = '00010'.
  lst_po_item_history-process_id   = '1'.
  lst_po_item_history-doc_year     = '2022'.
  lst_po_item_history-mat_doc	     = '5000001706'.
  lst_po_item_history-matdoc_itm   = '0001'.
  lst_po_item_history-hist_type	   = 'E'.
  lst_po_item_history-move_type	   = '101'.
  lst_po_item_history-pstng_date   = '20220225'.
  lst_po_item_history-quantity     = '100.000'.
  lst_po_item_history-val_loccur   = '8000.0000'.
  lst_po_item_history-val_forcur   = '8000.0000'.
  lst_po_item_history-currency     = 'EUR'.
  lst_po_item_history-db_cr_ind	   = 'S'.
  lst_po_item_history-no_more_gr   = 'X'.
  lst_po_item_history-entry_date   = '20220225'.
  lst_po_item_history-entry_time   = '170704'.
  lst_po_item_history-material     = '100-100'.
  lst_po_item_history-plant	       = '1043'.
  lst_po_item_history-loc_curr     = 'EUR'.
  lst_po_item_history-doc_date     = '20220225'.
  lst_po_item_history-currency_iso = 'EUR'.
  lst_po_item_history-loc_curr_iso = 'EUR'.

  APPEND lst_po_item_history TO <t_po_item_history>.


* PO item history totals
  CREATE DATA er_po_item_history_totals LIKE <t_po_item_history_totals>.
  ASSIGN er_po_item_history_totals->* TO <t_po_item_history_totals>.

  lst_po_item_history_totals-po_item    = '00010'.
  lst_po_item_history_totals-deliv_qty  = '100.000'.
  lst_po_item_history_totals-po_pr_qnt  = '100.000'.
  lst_po_item_history_totals-val_gr_loc	= '8000.0000'.
  lst_po_item_history_totals-val_gr_for	= '8000.0000'.

  APPEND lst_po_item_history_totals TO <t_po_item_history_totals>.

ENDMETHOD.
METHOD create_company_codes_01.

**************************************************************************************************
* Required for scenarios where Company Code used to select objects
* One company code: 1043

**************************************************************************************************

  FIELD-SYMBOLS: <t_sel_opt>       TYPE zdyn_cl_bapi=>yt_range_bukrs.
  DATA: lst_sel_opt     LIKE LINE OF <t_sel_opt>.

**************************************************************************************************
**************************************************************************************************
  CREATE DATA er_sel_opt LIKE <t_sel_opt>.
  ASSIGN er_sel_opt->* TO <t_sel_opt>.

  lst_sel_opt-low     = '1043'.
  lst_sel_opt-option  = 'EQ'.
  lst_sel_opt-sign    = 'I'.
  APPEND lst_sel_opt TO <t_sel_opt>.

ENDMETHOD.
METHOD CREATE_COMPANY_CODES_02.

**************************************************************************************************
* Required for scenarios where Company Code used to select objects
* Two company codes: 1043, 1049

**************************************************************************************************

  FIELD-SYMBOLS: <t_sel_opt>       TYPE zdyn_cl_bapi=>yt_range_bukrs.
  DATA: lst_sel_opt     LIKE LINE OF <t_sel_opt>.

**************************************************************************************************
**************************************************************************************************
  CREATE DATA er_sel_opt LIKE <t_sel_opt>.
  ASSIGN er_sel_opt->* TO <t_sel_opt>.

  lst_sel_opt-low     = '1043'.
  lst_sel_opt-option  = 'EQ'.
  lst_sel_opt-sign    = 'I'.
  APPEND lst_sel_opt TO <t_sel_opt>.

  lst_sel_opt-low     = '1049'.
  APPEND lst_sel_opt TO <t_sel_opt>.

ENDMETHOD.
METHOD create_fi_print_zterm.

**************************************************************************************************
* Required for scenario where Payment Term is sent from SAP to Routty

**************************************************************************************************

  FIELD-SYMBOLS: <t_texts>   TYPE zdyn_lstr_ttext.
  DATA: lst_text    LIKE LINE OF <t_texts>.

**************************************************************************************************
**************************************************************************************************
* Data for the BAPI in SAP
  CREATE DATA er_texts LIKE <t_texts>.
  ASSIGN er_texts->* TO <t_texts>.

  lst_text-text1 = 'Test payment term'.
  APPEND lst_text TO <t_texts>.

ENDMETHOD.
METHOD create_get_company_codes.

**************************************************************************************************
* Required for scenario where Company Code is sent from SAP to Routty

**************************************************************************************************

  FIELD-SYMBOLS: <t_sel_opt>       TYPE zdyn_cl_bapi=>yt_range_bukrs,
                 <t_company_codes> TYPE zdyn_lbukrs.
  DATA: lst_sel_opt     LIKE LINE OF <t_sel_opt>.

**************************************************************************************************
**************************************************************************************************
* Data for the BAPI in SAP
  CREATE DATA er_sel_opt LIKE <t_sel_opt>.
  ASSIGN er_sel_opt->* TO <t_sel_opt>.

  lst_sel_opt-low     = '1043'.
  lst_sel_opt-option  = 'EQ'.
  lst_sel_opt-sign    = 'I'.
  APPEND lst_sel_opt TO <t_sel_opt>.

  CREATE DATA er_company_codes LIKE <t_company_codes>.
  ASSIGN er_company_codes->* TO <t_company_codes>.

  APPEND '1043' TO <t_company_codes>.

ENDMETHOD.
METHOD create_get_company_codes_02.

**************************************************************************************************
* Required for scenario where Company Code is sent from SAP to Routty

**************************************************************************************************

  FIELD-SYMBOLS: "<t_sel_opt>       TYPE zdyn_cl_bapi=>yt_range_bukrs,
                 <t_company_codes> TYPE zdyn_lbukrs.
*  DATA: lst_sel_opt     LIKE LINE OF <t_sel_opt>.

**************************************************************************************************
**************************************************************************************************
** Data for the BAPI in SAP
*  CREATE DATA er_sel_opt LIKE <t_sel_opt>.
*  ASSIGN er_sel_opt->* TO <t_sel_opt>.
*
*  lst_sel_opt-low     = '1043'.
*  lst_sel_opt-option  = 'EQ'.
*  lst_sel_opt-sign    = 'I'.
*  APPEND lst_sel_opt TO <t_sel_opt>.

  CREATE DATA er_company_codes LIKE <t_company_codes>.
  ASSIGN er_company_codes->* TO <t_company_codes>.

  APPEND '1043' TO <t_company_codes>.
  APPEND '1049' TO <t_company_codes>.

ENDMETHOD.
METHOD CREATE_GET_COST_CENTERS_01.

**************************************************************************************************
* Required for scenario where Cost Center is sent from SAP to Routty
* One company code, 1043

**************************************************************************************************

  FIELD-SYMBOLS: <t_sel_opt>      TYPE zdyn_cl_bapi=>yt_range_kostl,
                 <t_cost_centers> TYPE zdyn_lstr_mkosts.
  DATA: lst_sel_opt     LIKE LINE OF <t_sel_opt>,
        lst_cost_center LIKE LINE OF <t_cost_centers>.

**************************************************************************************************
**************************************************************************************************
* Data for the BAPI in SAP
  CREATE DATA er_sel_opt LIKE <t_sel_opt>.
  ASSIGN er_sel_opt->* TO <t_sel_opt>.

  lst_sel_opt-low     = '1043'.
  lst_sel_opt-option  = 'EQ'.
  lst_sel_opt-sign    = 'I'.
  APPEND lst_sel_opt TO <t_sel_opt>.

  CREATE DATA er_cost_centers LIKE <t_cost_centers>.
  ASSIGN er_cost_centers->* TO <t_cost_centers>.

  lst_cost_center-kostl = '1043'.
  lst_cost_center-bukrs = '1043'.
  lst_cost_center-mctxt = 'Test Cost Center'.
  APPEND lst_cost_center TO <t_cost_centers>.

ENDMETHOD.
METHOD create_get_cost_centers_02.

**************************************************************************************************
* Required for scenario where Cost Center is sent from SAP to Routty
* One company code, 1049

**************************************************************************************************

  FIELD-SYMBOLS: <t_sel_opt>      TYPE zdyn_cl_bapi=>yt_range_kostl,
                 <t_cost_centers> TYPE zdyn_lstr_mkosts.
  DATA: lst_sel_opt     LIKE LINE OF <t_sel_opt>,
        lst_cost_center LIKE LINE OF <t_cost_centers>.

**************************************************************************************************
**************************************************************************************************
* Data for the BAPI in SAP
  CREATE DATA er_sel_opt LIKE <t_sel_opt>.
  ASSIGN er_sel_opt->* TO <t_sel_opt>.

  lst_sel_opt-low     = '1043'.
  lst_sel_opt-option  = 'EQ'.
  lst_sel_opt-sign    = 'I'.
  APPEND lst_sel_opt TO <t_sel_opt>.
  lst_sel_opt-low     = '2000'.
  APPEND lst_sel_opt TO <t_sel_opt>.

  CREATE DATA er_cost_centers LIKE <t_cost_centers>.
  ASSIGN er_cost_centers->* TO <t_cost_centers>.

  lst_cost_center-kostl = '2000'.
  lst_cost_center-bukrs = '1049'.
  lst_cost_center-mctxt = 'Test Cost Center 2'.
  APPEND lst_cost_center TO <t_cost_centers>.

ENDMETHOD.
METHOD create_get_currency_texts.

**************************************************************************************************
* Required for scenario where Currency is sent from SAP to Routty

**************************************************************************************************

  FIELD-SYMBOLS: <t_sel_opt>        TYPE zdyn_cl_bapi=>yt_range_waers,
                 <t_currency_texts> TYPE zdyn_lstr_tcurt.
  DATA: lst_currency_text LIKE LINE OF <t_currency_texts>,
        lst_sel_opt       LIKE LINE OF <t_sel_opt>.

**************************************************************************************************
**************************************************************************************************
* Data for the BAPI in SAP
  CREATE DATA er_sel_opt LIKE <t_sel_opt>.
  ASSIGN er_sel_opt->* TO <t_sel_opt>.

  lst_sel_opt-low     = 'EUR'.
  lst_sel_opt-option  = 'EQ'.
  lst_sel_opt-sign    = 'I'.
  APPEND lst_sel_opt TO <t_sel_opt>.

  CREATE DATA er_currency_texts LIKE <t_currency_texts>.
  ASSIGN er_currency_texts->* TO <t_currency_texts>.

  lst_currency_text-waers = 'EUR'.
  lst_currency_text-spras = 'EN'.
  lst_currency_text-ktext = 'Euro test'.
  APPEND lst_currency_text TO <t_currency_texts>.

ENDMETHOD.
METHOD create_get_customer_banks_01.

**************************************************************************************************
* Required for scenario where Customer is sent from SAP to Routty
* Customer 33000

**************************************************************************************************

  FIELD-SYMBOLS: <t_banks> TYPE STANDARD TABLE.
  DATA: lst_bank TYPE knbk.

**************************************************************************************************
**************************************************************************************************
* Data for the BAPI in SAP

  CREATE DATA er_banks TYPE STANDARD TABLE OF knbk.
  ASSIGN er_banks->* TO <t_banks>.

  lst_bank-mandt = '800'.
  lst_bank-kunnr = '0000022000'.
  lst_bank-banks = 'DE'.
  lst_bank-bankl = '25012345'.
  lst_bank-bankn = '21346541'.
  lst_bank-koinh = 'John Smith'.
  APPEND lst_bank TO <t_banks>.

ENDMETHOD.
METHOD create_get_customer_banks_02.

**************************************************************************************************
* Required for scenario where Customer is sent from SAP to Routty

**************************************************************************************************

  FIELD-SYMBOLS: <t_banks> TYPE STANDARD TABLE.
  DATA: lst_bank TYPE knbk.

**************************************************************************************************
**************************************************************************************************
* Data for the BAPI in SAP

  CREATE DATA er_banks TYPE STANDARD TABLE OF knbk.
  ASSIGN er_banks->* TO <t_banks>.

  lst_bank-mandt = '800'.
  lst_bank-kunnr = '0000033000'.
  lst_bank-banks = 'DE'.
  lst_bank-bankl = '55555'.
  lst_bank-bankn = '12345678901'.
  lst_bank-koinh = 'HSBC'.
  APPEND lst_bank TO <t_banks>.

ENDMETHOD.
METHOD create_get_customers.

**************************************************************************************************
* Required for scenario where Customer is sent from SAP to Routty

**************************************************************************************************

  FIELD-SYMBOLS: <t_sel_opt>   TYPE zdyn_cl_bapi=>yt_range_kunnr,
                 <t_customers> TYPE STANDARD TABLE.
  DATA: lst_customer TYPE zdyn_ws_cmd,
        lst_sel_opt  LIKE LINE OF <t_sel_opt>.


**************************************************************************************************
**************************************************************************************************
* Data for the BAPI in SAP
  CREATE DATA er_sel_opt LIKE <t_sel_opt>.
  ASSIGN er_sel_opt->* TO <t_sel_opt>.

  lst_sel_opt-low     = '0000022000'.
  lst_sel_opt-option  = 'EQ'.
  lst_sel_opt-sign    = 'I'.
  APPEND lst_sel_opt TO <t_sel_opt>.

  CREATE DATA er_customers TYPE STANDARD TABLE OF zdyn_ws_cmd.
  ASSIGN er_customers->* TO <t_customers>.

  lst_customer-mandt = '800'.
  lst_customer-kunnr = '0000022000'.
  lst_customer-land1 = 'FR'.
  lst_customer-name1 = 'IDES France SA'.
  lst_customer-ort01 = 'Paris'.
  lst_customer-pstlz = '75015'.
  lst_customer-stras = '31, rue des Erables'.
  lst_customer-telf1 = '01 49 74 45 45-'.
  lst_customer-telfx = '01 49 74 45 20-'.
  lst_customer-stceg = 'FR93341612695'.
  lst_customer-intca = 'FR'.
  lst_customer-bukrs = '1043'.
  lst_customer-zterm = 'ZB01'.
  lst_customer-erdat = '19970721'.
  lst_customer-pfach = '1030'.
  lst_customer-regio = '75'.
  lst_customer-adrnr = '0000006841'.
  lst_customer-waers = 'EUR'.
  APPEND lst_customer TO <t_customers>.

* Two customer registered for the same company code
  IF ii_num_of_customers = 2.
    lst_sel_opt-low     = '0000033000'.
    lst_sel_opt-option  = 'EQ'.
    lst_sel_opt-sign    = 'I'.
    APPEND lst_sel_opt TO <t_sel_opt>.

    lst_customer-mandt = '800'.
    lst_customer-kunnr = '0000033000'.
    lst_customer-land1 = 'FR'.
    lst_customer-name1 = 'IDES France SA 3'.
    lst_customer-ort01 = 'Paris 3'.
    lst_customer-pstlz = '33333'.
    lst_customer-stras = '33, rue des Erables'.
    lst_customer-telf1 = '03 49 74 45 45-'.
    lst_customer-telfx = '03 49 74 45 20-'.
    lst_customer-stceg = 'FR93341612693'.
    lst_customer-intca = 'FR'.
    lst_customer-bukrs = '1043'.
    lst_customer-zterm = 'ZB01'.
    lst_customer-erdat = '19970303'.
    lst_customer-pfach = '1033'.
    lst_customer-regio = '75'.
    lst_customer-adrnr = '0000006843'.
    lst_customer-waers = 'EUR'.
    APPEND lst_customer TO <t_customers>.
  ENDIF.

* One customer registered for two company codes
  IF ii_num_of_comp_codes = 2.
    lst_customer-mandt = '800'.
    lst_customer-kunnr = '0000022000'.
    lst_customer-land1 = 'FR'.
    lst_customer-name1 = 'IDES France SA 2'.  " the only difference
    lst_customer-ort01 = 'Paris'.
    lst_customer-pstlz = '75015'.
    lst_customer-stras = '31, rue des Erables'.
    lst_customer-telf1 = '01 49 74 45 45-'.
    lst_customer-telfx = '01 49 74 45 20-'.
    lst_customer-stceg = 'FR93341612695'.
    lst_customer-intca = 'FR'.
    lst_customer-bukrs = '1049'.
    lst_customer-zterm = 'ZB01'.
    lst_customer-erdat = '19970721'.
    lst_customer-pfach = '1030'.
    lst_customer-regio = '75'.
    lst_customer-adrnr = '0000006842'.
    lst_customer-waers = 'EUR'.
    APPEND lst_customer TO <t_customers>.
  ENDIF.

ENDMETHOD.
METHOD CREATE_GET_GL_ACC_DETAILS_01.

**************************************************************************************************
* Required for scenario where GL Account is sent from SAP to Routty

**************************************************************************************************

  FIELD-SYMBOLS: <st_details> TYPE skat.

**************************************************************************************************
**************************************************************************************************
* Data for the BAPI in SAP
  CREATE DATA er_details LIKE <st_details>.
  ASSIGN er_details->* TO <st_details>.

  <st_details>-saknr = '0000400000'.
  <st_details>-ktopl = 'INT'.
  <st_details>-spras = 'E'.
  <st_details>-txt20 = 'Consumptn, raw mat.1'.
  <st_details>-txt50 = 'Consumption, raw material 1'.

ENDMETHOD.
METHOD CREATE_GET_GL_ACC_DETAILS_02.

**************************************************************************************************
* Required for scenario where GL Account is sent from SAP to Routty

**************************************************************************************************

  FIELD-SYMBOLS: <st_details> TYPE skat.

**************************************************************************************************
**************************************************************************************************
* Data for the BAPI in SAP
  CREATE DATA er_details LIKE <st_details>.
  ASSIGN er_details->* TO <st_details>.

  <st_details>-saknr = '0000400000'.
  <st_details>-ktopl = 'INT'.
  <st_details>-spras = 'E'.
  <st_details>-txt20 = 'Consumptn, raw mat.2'.
  <st_details>-txt50 = 'Consumption, raw material 2'.

ENDMETHOD.
METHOD create_get_gl_accounts.

**************************************************************************************************
* Required for scenario where GL Account is sent from SAP to Routty

**************************************************************************************************

  FIELD-SYMBOLS: <t_sel_opt>     TYPE zdyn_cl_bapi=>yt_range_saknr,
                 <t_gl_accounts> TYPE zdyn_lstr_tgl_acct_cc.
  DATA: lst_gl_account LIKE LINE OF <t_gl_accounts>,
        lst_sel_opt    LIKE LINE OF <t_sel_opt>.

**************************************************************************************************
**************************************************************************************************
* Data for the BAPI in SAP
  CREATE DATA er_sel_opt LIKE <t_sel_opt>.
  ASSIGN er_sel_opt->* TO <t_sel_opt>.

  lst_sel_opt-low     = '0000400000'.
  lst_sel_opt-option  = 'EQ'.
  lst_sel_opt-sign    = 'I'.
  APPEND lst_sel_opt TO <t_sel_opt>.

  CREATE DATA er_gl_accounts LIKE <t_gl_accounts>.
  ASSIGN er_gl_accounts->* TO <t_gl_accounts>.

  lst_gl_account-saknr = '0000400000'.
  lst_gl_account-ktopl = 'INT'.
  lst_gl_account-bukrs = '1043'.
  APPEND lst_gl_account TO <t_gl_accounts>.

  IF ii_num_of_comp_codes = 2.
    lst_gl_account-saknr = '0000400000'.
    lst_gl_account-ktopl = 'INT'.
    lst_gl_account-bukrs = '1049'.
    APPEND lst_gl_account TO <t_gl_accounts>.
  ENDIF.

ENDMETHOD.
METHOD create_get_idoc_control_record.

**************************************************************************************************
* Required for scenario where Invoice is sent from Routty as IDOC to SAP

**************************************************************************************************

  FIELD-SYMBOLS: <st_record>   TYPE edidc.

**************************************************************************************************
**************************************************************************************************
* Data for the BAPI in SAP
  CREATE DATA er_record LIKE <st_record>.
  ASSIGN er_record->* TO <st_record>.

  <st_record>-docnum = '0000000003230747'.
  <st_record>-rcvprn = 'ROU_XML'.

ENDMETHOD.
METHOD create_get_orders.

**************************************************************************************************
* Required for scenario where Order is sent from SAP to Routty

**************************************************************************************************

  FIELD-SYMBOLS: <t_sel_opt> TYPE zdyn_cl_bapi=>yt_range_aufnr,
                 <t_orders>  TYPE zdyn_lstr_orders.
  DATA: lst_sel_opt LIKE LINE OF <t_sel_opt>,
        lst_order   LIKE LINE OF <t_orders>.

**************************************************************************************************
**************************************************************************************************
* Data for the BAPI in SAP
  CREATE DATA er_sel_opt LIKE <t_sel_opt>.
  ASSIGN er_sel_opt->* TO <t_sel_opt>.

  lst_sel_opt-low     = '000000101111'.
  lst_sel_opt-option  = 'EQ'.
  lst_sel_opt-sign    = 'I'.
  APPEND lst_sel_opt TO <t_sel_opt>.

  CREATE DATA er_orders LIKE <t_orders>.
  ASSIGN er_orders->* TO <t_orders>.

  lst_order-aufnr	= '000000101111'.
  lst_order-bukrs = '1043'.
  lst_order-ktext	= 'Sample Order For Development Orders'.
  lst_order-erdat	= sy-datlo.
  APPEND lst_order TO <t_orders>.

  IF ii_num_of_comp_codes = 2.
    lst_sel_opt-low     = '000000101112'.
    lst_sel_opt-option  = 'EQ'.
    lst_sel_opt-sign    = 'I'.
    APPEND lst_sel_opt TO <t_sel_opt>.

    lst_order-aufnr	= '000000101112'.
    lst_order-bukrs = '1049'.
    lst_order-ktext	= 'Sample Order For Development Orders 2'.
    lst_order-erdat	= sy-datlo.
    APPEND lst_order TO <t_orders>.
  ENDIF.


ENDMETHOD.
METHOD create_get_payment_terms.

**************************************************************************************************
* Required for scenario where Payment Term is sent from SAP to Routty

**************************************************************************************************

  FIELD-SYMBOLS: <t_sel_opt> TYPE zdyn_cl_bapi=>yt_range_zterm,
                 <t_terms>   TYPE zdyn_lstr_t052.
  DATA: lst_sel_opt LIKE LINE OF <t_sel_opt>,
        lst_term    LIKE LINE OF <t_terms>.

**************************************************************************************************
**************************************************************************************************
* Data for the BAPI in SAP
  CREATE DATA er_sel_opt LIKE <t_sel_opt>.
  ASSIGN er_sel_opt->* TO <t_sel_opt>.

  lst_sel_opt-low     = '0001'.
  lst_sel_opt-option  = 'EQ'.
  lst_sel_opt-sign    = 'I'.
  APPEND lst_sel_opt TO <t_sel_opt>.

  CREATE DATA er_terms LIKE <t_terms>.
  ASSIGN er_terms->* TO <t_terms>.

  lst_term-zterm = '0001'.
  APPEND lst_term TO <t_terms>.

ENDMETHOD.
METHOD create_get_tax_codes.

**************************************************************************************************
* Required for scenario where Tax Code is sent from SAP to Routty

**************************************************************************************************

  FIELD-SYMBOLS: <t_sel_opt>   TYPE zdyn_cl_bapi=>yt_range_mwskz,
                 <t_tax_codes> TYPE STANDARD TABLE.
  DATA: lst_sel_opt  LIKE LINE OF <t_sel_opt>,
        lst_tax_code TYPE zdyn_cl_bapi=>yst_tax_code.

**************************************************************************************************
**************************************************************************************************
* Data for the BAPI in SAP
  CREATE DATA er_sel_opt LIKE <t_sel_opt>.
  ASSIGN er_sel_opt->* TO <t_sel_opt>.

  lst_sel_opt-low     = 'V0'.
  lst_sel_opt-option  = 'EQ'.
  lst_sel_opt-sign    = 'I'.
  APPEND lst_sel_opt TO <t_sel_opt> .

  CREATE DATA er_tax_codes TYPE zdyn_cl_bapi=>yt_tax_codes.
  ASSIGN er_tax_codes->* TO <t_tax_codes>.

  lst_tax_code-comp_code = '1043'.
  lst_tax_code-procedure = 'TAXAT'.
  lst_tax_code-tax_code  = 'V0'.
  APPEND lst_tax_code TO <t_tax_codes>.

  IF ii_num_of_comp_codes = 2.
    lst_sel_opt-low     = 'V1'.
    lst_sel_opt-option  = 'EQ'.
    lst_sel_opt-sign    = 'I'.
    APPEND lst_sel_opt TO <t_sel_opt> .

    lst_tax_code-comp_code = '1049'.
    lst_tax_code-procedure = 'TAXD'.
    lst_tax_code-tax_code  = 'V1'.
    APPEND lst_tax_code TO <t_tax_codes>.
  ENDIF.

ENDMETHOD.
METHOD CREATE_GET_VENDOR_BANKS_01.

**************************************************************************************************
* Required for scenario where Supplier is sent from SAP to Routty
* Vendor 43001

**************************************************************************************************

  FIELD-SYMBOLS: <t_banks> TYPE zdyn_lstr_lfbk.
  DATA: lst_bank LIKE LINE OF <t_banks>.

**************************************************************************************************
**************************************************************************************************
* Data for the BAPI in SAP

  CREATE DATA er_banks LIKE <t_banks>.
  ASSIGN er_banks->* TO <t_banks>.

  lst_bank-mandt = '800'.
  lst_bank-lifnr = '0000043001'.
  lst_bank-banks = 'AT'.
  lst_bank-bankl = '19100'.
  lst_bank-bankn = '88877766655'.
  lst_bank-koinh = 'Hansi Müller'.
  APPEND lst_bank TO <t_banks>.

  lst_bank-mandt = '800'.
  lst_bank-lifnr = '0000043001'.
  lst_bank-banks = 'AT'.
  lst_bank-bankl = '19100'.
  lst_bank-bankn = '98765454321'.
  lst_bank-koinh = 'Hans Mustermann'.
  APPEND lst_bank TO <t_banks>.

ENDMETHOD.
METHOD create_get_vendor_banks_02.

**************************************************************************************************
* Required for scenario where Supplier is sent from SAP to Routty
* Vendor 44001

**************************************************************************************************

  FIELD-SYMBOLS: <t_banks> TYPE zdyn_lstr_lfbk.
  DATA: lst_bank LIKE LINE OF <t_banks>.

**************************************************************************************************
**************************************************************************************************
* Data for the BAPI in SAP

  CREATE DATA er_banks LIKE <t_banks>.
  ASSIGN er_banks->* TO <t_banks>.

  lst_bank-mandt = '800'.
  lst_bank-lifnr = '0000044001'.
  lst_bank-banks = 'DE'.
  lst_bank-bankl = '55555'.
  lst_bank-bankn = '12345678901'.
  lst_bank-koinh = 'HSBC'.
  APPEND lst_bank TO <t_banks>.

ENDMETHOD.
METHOD create_get_vendors.

**************************************************************************************************
* Required for scenario where Supplier is sent from SAP to Routty

**************************************************************************************************

  FIELD-SYMBOLS: <t_sel_opt> TYPE zdyn_cl_bapi=>yt_range_lifnr,
                 <t_vendors> TYPE zdyn_lstr_vmd.
  DATA: lst_vendor  LIKE LINE OF <t_vendors>,
        lst_sel_opt LIKE LINE OF <t_sel_opt>.

**************************************************************************************************
**************************************************************************************************
* Data for the BAPI in SAP
  CREATE DATA er_sel_opt LIKE <t_sel_opt>.
  ASSIGN er_sel_opt->* TO <t_sel_opt>.

  lst_sel_opt-low     = '0000043001'.
  lst_sel_opt-option  = 'EQ'.
  lst_sel_opt-sign    = 'I'.
  APPEND lst_sel_opt TO <t_sel_opt>.

  CREATE DATA er_vendors LIKE <t_vendors>.
  ASSIGN er_vendors->* TO <t_vendors>.

  lst_vendor-mandt = '800'.
  lst_vendor-lifnr = '0000043001'.
  lst_vendor-land1 = 'AT'.
  lst_vendor-name1 = 'OMV AG'.
  lst_vendor-ort01 = 'Wien'.
  lst_vendor-pstlz = '1020'.
  lst_vendor-stras = 'Rennbahnstrasse 6'.
  lst_vendor-stceg = 'ATU99999993'.
  lst_vendor-intca = 'AT'.
  lst_vendor-bukrs = '1043'.
  lst_vendor-zterm = '0001'.
  lst_vendor-zwels = 'AKLOSU'.
  lst_vendor-eikto = '43001'.
  lst_vendor-erdat = '20210414'.
  lst_vendor-regio = 'W'.
  lst_vendor-adrnr = '0000730189'.
  lst_vendor-waers = 'EUR'.
  APPEND lst_vendor TO <t_vendors>.

* Two vendors registered for the same company code
  IF ii_num_of_vendors = 2.
    lst_sel_opt-low     = '0000044001'.
    lst_sel_opt-option  = 'EQ'.
    lst_sel_opt-sign    = 'I'.
    APPEND lst_sel_opt TO <t_sel_opt>.

    lst_vendor-mandt = '800'.
    lst_vendor-lifnr = '0000044001'.
    lst_vendor-land1 = 'DE'.
    lst_vendor-name1 = 'Deutsch AG'.
    lst_vendor-ort01 = 'Berlin'.
    lst_vendor-pstlz = '1111'.
    lst_vendor-stras = 'Warschauerstrasse 2'.
    lst_vendor-stceg = 'DEU99999992'.
    lst_vendor-intca = 'DE'.
    lst_vendor-bukrs = '1043'.
    lst_vendor-zterm = '0001'.
    lst_vendor-zwels = 'AKLOSU'.
    lst_vendor-eikto = '44000'.
    lst_vendor-erdat = '20210515'.
    lst_vendor-regio = 'W'.
    lst_vendor-adrnr = '0000730200'.
    lst_vendor-waers = 'EUR'.
    APPEND lst_vendor TO <t_vendors>.
  ENDIF.

* One vendor registered for two company codes
  IF ii_num_of_comp_codes = 2.
    lst_vendor-mandt = '800'.
    lst_vendor-lifnr = '0000043001'.
    lst_vendor-land1 = 'AT'.
    lst_vendor-name1 = 'OMV AG 2'.    " the only difference
    lst_vendor-ort01 = 'Wien'.
    lst_vendor-pstlz = '1020'.
    lst_vendor-stras = 'Rennbahnstrasse 6'.
    lst_vendor-stceg = 'ATU99999993'.
    lst_vendor-intca = 'AT'.
    lst_vendor-bukrs = '1049'.
    lst_vendor-zterm = '0001'.
    lst_vendor-zwels = 'AKLOSU'.
    lst_vendor-eikto = '43001'.
    lst_vendor-erdat = '20210416'.
    lst_vendor-regio = 'W'.
    lst_vendor-adrnr = '0000730189'.
    lst_vendor-waers = 'EUR'.
    APPEND lst_vendor TO <t_vendors>.
  ENDIF.

ENDMETHOD.
METHOD create_get_wbs_elements.

**************************************************************************************************
* Required for scenario where WBS element is sent from SAP to Routty

**************************************************************************************************

  FIELD-SYMBOLS: <t_sel_opt>      TYPE zdyn_cl_bapi=>yt_range_pspnr,
                 <t_wbs_elements> TYPE zdyn_lstr_wbs_elements.
  DATA: lst_sel_opt     LIKE LINE OF <t_sel_opt>,
        lst_wbs_element LIKE LINE OF <t_wbs_elements>.

**************************************************************************************************
**************************************************************************************************
* Data for the BAPI in SAP
  CREATE DATA er_sel_opt LIKE <t_sel_opt>.
  ASSIGN er_sel_opt->* TO <t_sel_opt>.

  lst_sel_opt-low     = '00007552'.
  lst_sel_opt-option  = 'EQ'.
  lst_sel_opt-sign    = 'I'.
  APPEND lst_sel_opt TO <t_sel_opt>.

  CREATE DATA er_wbs_elements LIKE <t_wbs_elements>.
  ASSIGN er_wbs_elements->* TO <t_wbs_elements>.

  lst_wbs_element-pspnr	= '00007552'.
  lst_wbs_element-posid	= 'E4040131'.
  lst_wbs_element-pbukr = '1043'.
  lst_wbs_element-post1	= 'WBS Element E-4040-1-3-1'.
  lst_wbs_element-erdat	= sy-datlo.
  APPEND lst_wbs_element TO <t_wbs_elements>.

  IF ii_num_of_comp_codes = 2.
    lst_sel_opt-low     = '00007553'.
    lst_sel_opt-option  = 'EQ'.
    lst_sel_opt-sign    = 'I'.
    APPEND lst_sel_opt TO <t_sel_opt>.

    lst_wbs_element-pspnr	= '00007553'.
    lst_wbs_element-posid	= 'E4040133'.
    lst_wbs_element-pbukr = '1049'.
    lst_wbs_element-post1	= 'WBS Element E-4040-1-3-3'.
    lst_wbs_element-erdat	= sy-datlo.
    APPEND lst_wbs_element TO <t_wbs_elements>.
  ENDIF.

ENDMETHOD.
METHOD create_langu.

**************************************************************************************************
* Required for scenario with Cost Centers, GL Accounts, Payment Terms and Tax codes

**************************************************************************************************

  FIELD-SYMBOLS: <t_sel_langu> TYPE zdyn_cl_bapi=>yt_range_langu.
  DATA: lst_sel_langu LIKE LINE OF <t_sel_langu>.

**************************************************************************************************
  CREATE DATA er_sel_langu LIKE <t_sel_langu>.
  ASSIGN er_sel_langu->* TO <t_sel_langu>.

  lst_sel_langu-low     = 'E'.
  lst_sel_langu-option  = 'EQ'.
  lst_sel_langu-sign    = 'I'.
  APPEND lst_sel_langu TO <t_sel_langu>.

ENDMETHOD.
METHOD CREATE_RFC_DATA_SUBMIT_DATA_FI.

**************************************************************************************************
* Scenario for invoice transfer from Routty to PD

**************************************************************************************************
  FIELD-SYMBOLS: <t_extdata>   TYPE zdyn_lstru_extdata,
                 <t_archiving> TYPE zdyn_lstru_archive,
                 <t_content>   TYPE rmps_t_1024,
                 <st_bo_hdr>   TYPE zdyn_stru_bo_hdr,
                 <st_status>   TYPE zdyn_stru_bo_rfcstatus,
                 <t_messages>  TYPE zdyn_lstru_pd_message.
  DATA: lst_extdata   LIKE LINE OF <t_extdata>,
        lst_archiving LIKE LINE OF <t_archiving>,
        lst_content   LIKE LINE OF <t_content>,
        lst_message   LIKE LINE OF <t_messages>.


**************************************************************************************************
**************************************************************************************************
* Data for the RFC in PD

* External data
  CREATE DATA er_rfc_extdata LIKE <t_extdata>.
  ASSIGN er_rfc_extdata->* TO <t_extdata>.

* Header
  add_extdata 'HEADER' '000001' '' '000000' 'GUID' '001' '41babc06-9205-4ea7-ae84-3faf8860c70e'.
  add_extdata 'HEADER' '000001' '' '000000' 'STCEG' '001' 'ATU99999993'.
  add_extdata 'HEADER' '000001' '' '000000' 'IBAN1' '001' 'AT421910098765454321'.
  add_extdata 'HEADER' '000001' '' '000000' 'VENDOR_NO' '001' '43001'.
  add_extdata 'HEADER' '000001' '' '000000' 'COMP_CODE' '001' '1043'.
  add_extdata 'HEADER' '000001' '' '000000' 'INVOICE_IND' '001' 'X'.
  add_extdata 'HEADER' '000001' '' '000000' 'REF_DOC_NO' '001' 'IV_4500022682_1'.
  add_extdata 'HEADER' '000001' '' '000000' 'DOC_DATE' '001' '20220221'.
  add_extdata 'HEADER' '000001' '' '000000' 'PO_NUMBER' '001' '4500022682'.
  add_extdata 'HEADER' '000001' '' '000000' 'CURRENCY_ISO' '001' 'EUR'.
  add_extdata 'HEADER' '000001' '' '000000' 'NET_AMOUNT' '001' '8000.000000000'.
  add_extdata 'HEADER' '000001' '' '000000' 'GROSS_AMOUNT' '001' '9520.000000000'.
  add_extdata 'HEADER' '000001' '' '000000' 'BLINE_DATE' '001' '20220221'.
  add_extdata 'HEADER' '000001' '' '000000' 'PSTNG_DATE' '001' '20220221'.

* Account assignment
  add_extdata 'ACCOUNT' '000001' 'HEADER' '000001' 'GL_ACCOUNT' '001' '0000400000'.
  add_extdata 'ACCOUNT' '000001' 'HEADER' '000001' 'NET_AMOUNT' '001' '8000.000000000'.
  add_extdata 'ACCOUNT' '000001' 'HEADER' '000001' 'COSTCENTER' '001' '1043'.
  add_extdata 'ACCOUNT' '000001' 'HEADER' '000001' 'TAX_CODE' '001' 'VA'.
  add_extdata 'ACCOUNT' '000001' 'HEADER' '000001' 'TAX_AMOUNT' '001' '1520.000000000'.

* Taxes
  add_extdata 'TAX' '000001' 'HEADER' '000001' 'TAX_AMOUNT' '001' '1520.000000000'.

* Attachment links
  add_extdata 'CUSTOM' '000001' 'HEADER' '000001' 'NAME' '001' 'GUID'.
  add_extdata 'CUSTOM' '000001' 'HEADER' '000001' 'VALUE' '001' '41babc06-9205-4ea7-ae84-3faf8860c70e'.
  add_extdata 'CUSTOM' '000002' 'HEADER' '000001' 'NAME' '001' 'ATTACHMENT1'.
  add_extdata 'CUSTOM' '000002' 'HEADER' '000001' 'VALUE' '001' 'X2PaQk6QaOlqtJGsFTIt1g=='.
  add_extdata 'CUSTOM' '000003' 'HEADER' '000001' 'NAME' '001' 'ATTACHMENT2'.
  add_extdata 'CUSTOM' '000003' 'HEADER' '000001' 'VALUE' '001' 'TooELfAdWi1JVO+OyCOzyg=='.

**********************************************************************
* Archiving
  CREATE DATA er_rfc_archiving LIKE <t_archiving>.
  ASSIGN er_rfc_archiving->* TO <t_archiving>.

  lst_archiving-binlength = '000000000028'.
  lst_archiving-mimetype  = 'application/pdf'.
  lst_archiving-firstline = '000001'.
  lst_archiving-lastline  = '000001'.
  lst_archiving-filename  = '41babc06-9205-4ea7-ae84-3faf8860c70e_generated.pdf'.
  APPEND lst_archiving TO <t_archiving>.

  lst_archiving-binlength = '000000000023'.
  lst_archiving-mimetype  = 'text/xml'.
  lst_archiving-firstline = '000002'.
  lst_archiving-lastline  = '000002'.
  lst_archiving-filename  = 'Base_41babc06-9205-4ea7-ae84-3faf8860c70e.xml'.
  APPEND lst_archiving TO <t_archiving>.

**********************************************************************
* CONTENT
  CREATE DATA er_rfc_content LIKE <t_content>.
  ASSIGN er_rfc_content->* TO <t_content>.

  lst_content-line = '546869732069732067656E657261746564206174746163686D656E74'.
  APPEND lst_content TO <t_content>.
  lst_content-line = '546869732069732042617365206174746163686D656E74'.
  APPEND lst_content TO <t_content>.

**********************************************************************
* BO header
  CREATE DATA er_rfc_bo_hdr LIKE <st_bo_hdr>.
  ASSIGN er_rfc_bo_hdr->* TO <st_bo_hdr>.

  <st_bo_hdr>-client            = '800'.
  <st_bo_hdr>-guid              = '41BABC0692054EA7AE843FAF8860C70E'.
  <st_bo_hdr>-obj	              = 'IV'.
  <st_bo_hdr>-env	              = 'XB'.
  <st_bo_hdr>-numbr	            = '3010'.
  <st_bo_hdr>-sysusr            = 'USER'.
  <st_bo_hdr>-mod_usertype      = 'S'.
  <st_bo_hdr>-mod_user          = 'USER'.
  <st_bo_hdr>-change_tstamp	    = '20220224133620.5699190'.
  <st_bo_hdr>-create_tstamp	    = '20220224133613.1384590'.
  <st_bo_hdr>-creator_usertype  = 'S'.
  <st_bo_hdr>-creator_user      = 'USER'.

**********************************************************************
* Status
  CREATE DATA er_rfc_status LIKE <st_status>.
  ASSIGN er_rfc_status->* TO <st_status>.

  <st_status>-retcode = 'S'.

**********************************************************************
* Messages
  CREATE DATA er_rfc_messages LIKE <t_messages>.
  ASSIGN er_rfc_messages->* TO <t_messages>.

  lst_message-msg_type  = 'S'.
  lst_message-msg_id    = '/COCKPIT/GEN'.
  lst_message-msg_no    = '011'.
  lst_message-msg_txt   = 'Document transferred from ROUTTY 41BABC0692054EA7AE843FAF8860C70E to PDAP 00000000003011'.
  APPEND lst_message TO <t_messages>.

ENDMETHOD.
METHOD create_rfc_data_submit_data_mm.

**************************************************************************************************
* Scenario for invoice transfer from Routty to PD

**************************************************************************************************
  FIELD-SYMBOLS: <t_extdata>   TYPE zdyn_lstru_extdata,
                 <t_archiving> TYPE zdyn_lstru_archive,
                 <t_content>   TYPE rmps_t_1024,
                 <st_bo_hdr>   TYPE zdyn_stru_bo_hdr,
                 <st_status>   TYPE zdyn_stru_bo_rfcstatus,
                 <t_messages>  TYPE zdyn_lstru_pd_message.
  DATA: lst_extdata   LIKE LINE OF <t_extdata>,
        lst_archiving LIKE LINE OF <t_archiving>,
        lst_content   LIKE LINE OF <t_content>,
        lst_message   LIKE LINE OF <t_messages>.


**************************************************************************************************
**************************************************************************************************
* Data for the RFC in PD

* External data
  CREATE DATA er_rfc_extdata LIKE <t_extdata>.
  ASSIGN er_rfc_extdata->* TO <t_extdata>.

* Header
  add_extdata 'HEADER' '000001' '' '000000' 'GUID' '001' '41babc06-9205-4ea7-ae84-3faf8860c70e'.
  add_extdata 'HEADER' '000001' '' '000000' 'STCEG' '001' 'ATU99999993'.
  add_extdata 'HEADER' '000001' '' '000000' 'IBAN1' '001' 'AT421910098765454321'.
  add_extdata 'HEADER' '000001' '' '000000' 'VENDOR_NO' '001' '43001'.
  add_extdata 'HEADER' '000001' '' '000000' 'COMP_CODE' '001' '1043'.
  add_extdata 'HEADER' '000001' '' '000000' 'INVOICE_IND' '001' 'X'.
  add_extdata 'HEADER' '000001' '' '000000' 'REF_DOC_NO' '001' 'IV_4500022682_1'.
  add_extdata 'HEADER' '000001' '' '000000' 'DOC_DATE' '001' '20220221'.
  add_extdata 'HEADER' '000001' '' '000000' 'PO_NUMBER' '001' '4500022682'.
  add_extdata 'HEADER' '000001' '' '000000' 'CURRENCY_ISO' '001' 'EUR'.
  add_extdata 'HEADER' '000001' '' '000000' 'NET_AMOUNT' '001' '8000.000000000'.
  add_extdata 'HEADER' '000001' '' '000000' 'GROSS_AMOUNT' '001' '9520.000000000'.
  add_extdata 'HEADER' '000001' '' '000000' 'BLINE_DATE' '001' '20220221'.
  add_extdata 'HEADER' '000001' '' '000000' 'PSTNG_DATE' '001' '20220221'.
  IF ib_express = abap_true.
    add_extdata 'HEADER' '000001' '' '000000' 'INPUT_CHANNEL' '001' 'PEPPOL'.
  ENDIF.
  IF ib_with_pdap = abap_true.
    add_extdata 'HEADER' '000001' '' '000000' 'REVERSAL_DOC' '001' 'ABC'.
  ENDIF.

* Items
  add_extdata 'ITEM' '000001' 'HEADER' '000001' 'PO_NUMBER' '001' '4500022682'.
  add_extdata 'ITEM' '000001' 'HEADER' '000001' 'ITEM_TEXT' '001' 'Casings'.
  add_extdata 'ITEM' '000001' 'HEADER' '000001' 'QUANTITY' '001' '100.000'.
  add_extdata 'ITEM' '000001' 'HEADER' '000001' 'PO_UNIT_ISO' '001' 'H87'.
  add_extdata 'ITEM' '000001' 'HEADER' '000001' 'ITEM_AMOUNT' '001' '8000.000000000'.
  add_extdata 'ITEM' '000001' 'HEADER' '000001' 'POS_NO' '001' '1'.
  IF ib_with_custom = abap_true.
    add_extdata 'ITEM' '000001' 'HEADER' '000001' 'ZFIELD1' '001' 'ITEM_CUST_VALUE_1'.
    add_extdata 'ITEM' '000001' 'HEADER' '000001' 'ZFIELD2' '001' 'ITEM_CUST_VALUE_2'.
  ENDIF.
  IF ib_with_pdap = abap_true.
    add_extdata 'ITEM' '000001' 'HEADER' '000001' 'FINAL_INV' '001' 'X'.
  ENDIF.

* Taxes
  add_extdata 'TAX' '000001' 'HEADER' '000001' 'TAX_AMOUNT' '001' '1520.000000000'.

* Attachment links
  add_extdata 'CUSTOM' '000001' 'HEADER' '000001' 'NAME' '001' 'GUID'.
  add_extdata 'CUSTOM' '000001' 'HEADER' '000001' 'VALUE' '001' '41babc06-9205-4ea7-ae84-3faf8860c70e'.
  IF ib_with_custom = abap_true.
    add_extdata 'CUSTOM' '000002' 'HEADER' '000001' 'NAME' '001' 'DIMENSION1'.
    add_extdata 'CUSTOM' '000002' 'HEADER' '000001' 'VALUE' '001' 'HDR_CUST_VALUE_1'.
    add_extdata 'CUSTOM' '000003' 'HEADER' '000001' 'NAME' '001' 'DIMENSION2'.
    add_extdata 'CUSTOM' '000003' 'HEADER' '000001' 'VALUE' '001' 'HDR_CUST_VALUE_2'.
    add_extdata 'CUSTOM' '000004' 'HEADER' '000001' 'NAME' '001' 'ATTACHMENT1'.
    add_extdata 'CUSTOM' '000004' 'HEADER' '000001' 'VALUE' '001' 'X2PaQk6QaOlqtJGsFTIt1g=='.
    add_extdata 'CUSTOM' '000005' 'HEADER' '000001' 'NAME' '001' 'ATTACHMENT2'.
    add_extdata 'CUSTOM' '000005' 'HEADER' '000001' 'VALUE' '001' 'TooELfAdWi1JVO+OyCOzyg=='.
*    add_extdata 'CUSTOM' '000006' 'HEADER' '000001' 'NAME' '001' 'DIMENSION4'.
*    add_extdata 'CUSTOM' '000006' 'HEADER' '000001' 'VALUE' '001' 'Just any value'.
  ELSE.
    add_extdata 'CUSTOM' '000002' 'HEADER' '000001' 'NAME' '001' 'ATTACHMENT1'.
    add_extdata 'CUSTOM' '000002' 'HEADER' '000001' 'VALUE' '001' 'X2PaQk6QaOlqtJGsFTIt1g=='.
    add_extdata 'CUSTOM' '000003' 'HEADER' '000001' 'NAME' '001' 'ATTACHMENT2'.
    add_extdata 'CUSTOM' '000003' 'HEADER' '000001' 'VALUE' '001' 'TooELfAdWi1JVO+OyCOzyg=='.
  ENDIF.

**********************************************************************
* Archiving
  CREATE DATA er_rfc_archiving LIKE <t_archiving>.

  IF ib_skip_attach = abap_false.
    ASSIGN er_rfc_archiving->* TO <t_archiving>.

    lst_archiving-binlength = '000000000028'.
    lst_archiving-mimetype  = 'application/pdf'.
    lst_archiving-firstline = '000001'.
    lst_archiving-lastline  = '000001'.
    lst_archiving-filename  = '41babc06-9205-4ea7-ae84-3faf8860c70e_generated.pdf'.
    APPEND lst_archiving TO <t_archiving>.

    lst_archiving-binlength = '000000000023'.
    lst_archiving-mimetype  = 'text/xml'.
    lst_archiving-firstline = '000002'.
    lst_archiving-lastline  = '000002'.
    lst_archiving-filename  = 'Base_41babc06-9205-4ea7-ae84-3faf8860c70e.xml'.
    APPEND lst_archiving TO <t_archiving>.
  ENDIF.

**********************************************************************
* CONTENT
  CREATE DATA er_rfc_content LIKE <t_content>.

  IF ib_skip_attach = abap_false.
    ASSIGN er_rfc_content->* TO <t_content>.

    lst_content-line = '546869732069732067656E657261746564206174746163686D656E74'.
    APPEND lst_content TO <t_content>.
    lst_content-line = '546869732069732042617365206174746163686D656E74'.
    APPEND lst_content TO <t_content>.
  ENDIF.

**********************************************************************
* BO header
  CREATE DATA er_rfc_bo_hdr LIKE <st_bo_hdr>.
  ASSIGN er_rfc_bo_hdr->* TO <st_bo_hdr>.

  <st_bo_hdr>-client            = '800'.
  <st_bo_hdr>-guid              = '41BABC0692054EA7AE843FAF8860C70E'.
  <st_bo_hdr>-obj	              = 'IV'.
  <st_bo_hdr>-env	              = 'XB'.
  <st_bo_hdr>-numbr	            = '3010'.
  <st_bo_hdr>-sysusr            = 'USER'.
  <st_bo_hdr>-mod_usertype      = 'S'.
  <st_bo_hdr>-mod_user          = 'USER'.
  <st_bo_hdr>-change_tstamp	    = '20220224133620.5699190'.
  <st_bo_hdr>-create_tstamp	    = '20220224133613.1384590'.
  <st_bo_hdr>-creator_usertype  = 'S'.
  <st_bo_hdr>-creator_user      = 'USER'.

**********************************************************************
* Status
  CREATE DATA er_rfc_status LIKE <st_status>.
  ASSIGN er_rfc_status->* TO <st_status>.

  <st_status>-retcode = 'S'.

**********************************************************************
* Messages
  CREATE DATA er_rfc_messages LIKE <t_messages>.
  ASSIGN er_rfc_messages->* TO <t_messages>.

  lst_message-msg_type  = 'S'.
  lst_message-msg_id    = '/COCKPIT/GEN'.
  lst_message-msg_no    = '011'.
  lst_message-msg_txt   = 'Document transferred from ROUTTY 41BABC0692054EA7AE843FAF8860C70E to PDAP 00000000003011'.
  APPEND lst_message TO <t_messages>.

ENDMETHOD.
METHOD evaluate.

  DATA: lo_ut  TYPE REF TO zdyn_cl_ws_ut,
        ls_msg TYPE string,
        ls_id  TYPE string.
  FIELD-SYMBOLS: <st_scenario> LIKE LINE OF mst_scenario-scenario.

  CREATE OBJECT lo_ut.

  LOOP AT mst_scenario-scenario ASSIGNING <st_scenario>.
    ls_id = <st_scenario>-id.
    CONCATENATE 'ID:' ls_id ', method:' <st_scenario>-method ', param:' <st_scenario>-param '- not ok' INTO ls_msg SEPARATED BY space.
    lo_ut->assert_true( act = <st_scenario>-ok
                        msg = ls_msg ).
  ENDLOOP.

ENDMETHOD.
METHOD remove_special_char.

  DATA: lc TYPE c.

  CHECK cs IS NOT INITIAL.

  CALL FUNCTION 'SCP_TRANSLATE_CHARS'
    EXPORTING
      inbuff  = ix_char
    IMPORTING
      outbuff = lc.

  CHECK lc IS NOT INITIAL.
  REPLACE ALL OCCURRENCES OF lc IN cs WITH ''.
  CONDENSE cs NO-GAPS.

ENDMETHOD.
METHOD remove_special_chars.

  zdyn_cl_scenario_test=>remove_special_char(
    EXPORTING ix_char = '0A'
    CHANGING cs = cs ).

  zdyn_cl_scenario_test=>remove_special_char(
    EXPORTING ix_char = '0D'
    CHANGING cs = cs ).

  zdyn_cl_scenario_test=>remove_special_char(
    EXPORTING ix_char = '23'
    CHANGING cs = cs ).

  zdyn_cl_scenario_test=>remove_special_char(
    EXPORTING ix_char = '20'
    CHANGING cs = cs ).

ENDMETHOD.
METHOD set_xml_compressed.

  mb_xml_compressed = ib_compressed.

ENDMETHOD.
