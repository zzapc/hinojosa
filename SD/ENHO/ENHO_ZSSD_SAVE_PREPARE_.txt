<?xml version="1.0" encoding="utf-8"?> <ENHO enhancement_id="ZSSD_SAVE_PREPARE" shorttext="Enhacement user" tooltype_id="HOOK_IMPL" orig_object="R3TR-ZSSD_PREISFINDUNG-ENHO-ZSSD_PREISFINDUNG">  <asx:abap xmlns:asx="http://www.sap.com/abapxml" version="1.0
">   <asx:values>    <IMPLS>     <ENH_HOOK_IMPL>      <SPOTNAME/>      <PROGRAMNAME>ZSSD_PREISFINDUNG</PROGRAMNAME>      <EXTID>1</EXTID>      <ID>1</ID>      <OVERWRITE/>      <METHOD/>      <ENHMODE>D</ENHMODE>      <FULL_NAME>\PR:SAPMV45A\FO:USEREXIT_S
AVE_DOCUMENT_PREPARE\SE:END\EN:ZSSD_PREISFINDUNG\SE:END\EI</FULL_NAME>      <SOURCE>       <item/>       <item>*  SMT - INI - Si todo va bien lanzamos IDOC de pedidos.</item>       <item>CALL FUNCTION &apos;ZSSD_SEND_IDOC_SALES&apos; IN UPDATE TASK</item>
       <item>EXPORTING</item>       <item>i_handle = vbak-handle</item>       <item>i_trtyp  = t180-trtyp.</item>       <item>*  SMT - FIN</item>       <item/>       <item>&quot;ASC 25.03.24 No es necesario controlarlo, se hace por rutina de copia</item>
      <item>****  &quot;INI HLM - GAPSD058 - Chequeo validar status de oferta referencia</item>       <item>****  DATA lw_status_valido TYPE zssdt_so_jest. CLEAR lw_status_valido.</item>       <item>****  SELECT SINGLE *</item>       <item>****    INTO lw
_status_valido</item>       <item>****    FROM zssdt_so_jest</item>       <item>****    WHERE vkorg EQ vbak-vkorg</item>       <item>****      AND vtweg EQ vbak-vtweg</item>       <item>****      AND spart EQ vbak-spart</item>       <item>****      AND au
art EQ vbak-auart.</item>       <item>****</item>       <item>****  IF sy-subrc EQ 0. &quot;Clase de documento de ventas válido por Org.Ventas/Canal/Sector</item>       <item>****    IF sy-tcode EQ &apos;VA01&apos; OR sy-tcode EQ &apos;VA02&apos;.</item>
      <item>****      LOOP AT xvbap INTO wa_vbap WHERE updkz NE &apos;D&apos;.</item>       <item>****        DATA l_objnr TYPE j_objnr. CLEAR l_objnr.</item>       <item>****        l_objnr = |VB{ wa_vbap-vgbel ALPHA = IN }{ wa_vbap-vgpos ALPHA = IN }|.<
/item>       <item>****</item>       <item>****        DATA lw_jest TYPE jest. CLEAR lw_jest.</item>       <item>****        SELECT SINGLE *</item>       <item>****          INTO lw_jest</item>       <item>****          FROM jest</item>       <item>****
        WHERE objnr EQ l_objnr</item>       <item>****            AND inact EQ space</item>       <item>****            AND stat LIKE &apos;E%&apos;.</item>       <item>****</item>       <item>****        IF sy-subrc EQ 0.</item>       <item>*****
  SELECT SINGLE *</item>       <item>*****            INTO lw_so_jest</item>       <item>*****            FROM zssdt_so_jest</item>       <item>*****            WHERE vkorg EQ vbak-vkorg</item>       <item>*****              AND vtweg EQ vbak-vtweg</item>
       <item>*****              AND spart EQ vbak-spart</item>       <item>*****              AND auart EQ vbak-auart</item>       <item>*****              AND status EQ lw_jest-stat.</item>       <item>****</item>       <item>****          IF lw_status_v
alido-status NE lw_jest-stat. &quot;Chequeo de status válido.</item>       <item>****            DATA(l_msg) = |Revisar posición { wa_vbap-posnr ALPHA = OUT } |. CONDENSE l_msg.</item>       <item>****            MESSAGE e304(ZSD) WITH l_msg DISPLAY LIKE
&apos;I&apos;.</item>       <item>****          ENDIF.</item>       <item>****        ENDIF.</item>       <item>****      ENDLOOP.</item>       <item>****    ENDIF.</item>       <item>****  ENDIF. &quot;FIN HLM- GAPSD058</item>      </SOURCE>      <PARENT
_FULL_NAME>\PR:SAPMV45A\FO:USEREXIT_SAVE_DOCUMENT_PREPARE\SE:END</PARENT_FULL_NAME>     </ENH_HOOK_IMPL>    </IMPLS>   </asx:values>  </asx:abap> </ENHO>
